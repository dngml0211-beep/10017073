<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶í´ëŸ½ 3.0 - KRS ë„ì„œê´€</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { bg: '#FEF3C7', primary: '#FF9F43', dark: '#F368E0', secondary: '#54a0ff', green: '#1dd1a1', paper: '#FDFBF7' }
                    }
                }
            }
        }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&family=Noto+Sans+KR:wght@300;400;500;700&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/sidebar.css">
    <link rel="stylesheet" href="../css/responsive.css">

    <style>
        .font-noto { font-family: 'Noto Sans KR', sans-serif; }
        .font-batang { font-family: 'Gowun Batang', serif; }
        .font-display { font-family: 'Playfair Display', serif; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }

        /* === Premium Header === */
        .library-header {
            background: linear-gradient(135deg, #fff8f0 0%, #fff4e6 50%, #fef3c7 100%);
            border-bottom: 1px solid rgba(255, 159, 67, 0.1);
        }
        .header-top-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        .header-brand {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .header-brand-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #FF9F43, #f97316);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 3px 12px rgba(255, 159, 67, 0.3);
        }
        .header-brand-text {
            display: flex;
            flex-direction: column;
            gap: 1px;
        }
        .header-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 700;
            color: #1a1a1a;
            line-height: 1.2;
            letter-spacing: -0.02em;
        }
        .header-subtitle {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 11px;
            color: #9ca3af;
            font-weight: 400;
        }
        .header-level-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            background: white;
            border: 1px solid rgba(255, 159, 67, 0.2);
            border-radius: 20px;
            padding: 6px 12px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
        }
        .header-level-badge .level-label {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: #FF9F43;
        }
        .header-level-badge .level-bar {
            width: 56px;
            height: 5px;
            background: #f3f4f6;
            border-radius: 999px;
            overflow: hidden;
        }
        .header-level-badge .level-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF9F43, #f97316);
            border-radius: 999px;
            transition: width 0.6s ease;
        }
        .header-level-badge .level-count {
            font-size: 11px;
            color: #9ca3af;
            font-weight: 500;
        }

        /* === Tab Switcher (Duolingo-style) === */
        .tab-switcher {
            display: flex;
            background: white;
            border-radius: 14px;
            padding: 4px;
            gap: 4px;
            box-shadow: 0 1px 6px rgba(0,0,0,0.06), 0 0 0 1px rgba(0,0,0,0.03);
        }
        .tab-pill {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 11px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #b0a090;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }
        .tab-pill i {
            font-size: 15px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .tab-pill:hover:not(.active) {
            background: #fdf8f3;
            color: #8b7560;
        }
        .tab-pill.active {
            background: linear-gradient(135deg, #FF9F43, #f97316);
            color: white;
            box-shadow: 0 3px 12px rgba(255, 159, 67, 0.35);
            transform: scale(1);
        }
        .tab-pill.active i {
            color: white;
            animation: tabIconPop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes tabIconPop {
            0% { transform: scale(0.8) rotate(-10deg); }
            60% { transform: scale(1.15) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        .tab-pill .tab-emoji {
            font-size: 16px;
            display: inline-block;
            transition: transform 0.3s ease;
        }
        .tab-pill.active .tab-emoji {
            animation: emojiWave 0.6s ease;
        }
        @keyframes emojiWave {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-12deg); }
            75% { transform: rotate(12deg); }
        }

        .tab-content { display: none; animation: tabFadeIn 0.35s ease; }
        .tab-content.active { display: block; }
        @keyframes tabFadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* === Page Header === */
        .page-header {
            background: transparent;
            border-bottom: none;
        }

        /* === Month Section === */
        .month-section {
            margin-bottom: 20px;
        }
        .month-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 0 4px 10px;
            cursor: pointer;
            user-select: none;
            border-bottom: 2px solid #e8e0d4;
            transition: all 0.2s;
        }
        .month-header:hover {
            border-bottom-color: #FF9F43;
        }
        .month-title-text {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 1.3rem;
            font-weight: 800;
            color: #2d1b0e;
        }
        .month-title-num {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 1.3rem;
            font-weight: 800;
            color: #FF9F43;
        }
        .month-toggle {
            margin-left: auto;
            width: 28px;
            height: 28px;
            border-radius: 8px;
            background: rgba(255,159,67,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #FF9F43;
            font-size: 12px;
            transition: all 0.3s;
        }
        .month-toggle.collapsed { transform: rotate(-90deg); }
        .month-body {
            overflow: hidden;
            transition: max-height 0.4s ease, opacity 0.3s ease;
            max-height: 2000px;
            opacity: 1;
        }
        .month-body.collapsed {
            max-height: 0;
            opacity: 0;
        }
        .month-completed-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 3px 10px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 700;
            background: rgba(16,185,129,0.1);
            color: #10b981;
        }

        /* ì™„ë£Œëœ ê°œì›” - ë¹„í™œì„± ìŠ¤íƒ€ì¼ */
        .month-section.completed .month-title-num {
            color: #6b7280;
        }
        .month-section.completed .month-toggle {
            background: rgba(107,114,128,0.1);
            color: #9ca3af;
        }
        .month-section.completed .month-header {
            opacity: 0.75;
        }

        /* === Week Card Grid === */
        .week-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        @media (max-width: 640px) {
            .week-grid { grid-template-columns: 1fr; }
        }

        /* === Week Card === */
        .week-card {
            background: white;
            border-radius: 16px;
            border: 1px solid #f0ebe3;
            overflow: hidden;
            transition: all 0.25s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .week-card:hover {
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }
        .week-card.in-progress {
            background: linear-gradient(135deg, #FFFCF5, #FFF6E8);
            border: 2px solid #FF9F43;
            box-shadow: 0 4px 16px rgba(255,159,67,0.15), 0 0 0 3px rgba(255,159,67,0.06);
        }
        .week-card.in-progress:hover {
            box-shadow: 0 8px 28px rgba(255,159,67,0.2), 0 0 0 3px rgba(255,159,67,0.1);
        }
        .week-card.in-progress .week-card-header {
            border-bottom-color: rgba(255,159,67,0.15);
        }
        .week-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            border-bottom: 1px solid #f5f0e8;
        }
        .week-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .week-num {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 700;
            color: white;
            background: #2d3748;
        }
        .week-level {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            color: #4a5568;
            background: #f0f0f0;
            border: 1px solid #e2e8f0;
        }
        .week-status {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            font-weight: 600;
        }
        .week-status.completed { color: #10b981; }
        .week-status.in-progress { color: #FF9F43; }
        .week-status.locked { color: #9ca3af; }

        /* Book Info Area */
        .week-card-body {
            padding: 16px;
            display: flex;
            gap: 14px;
        }
        .book-cover-box {
            flex-shrink: 0;
            width: 90px;
            height: 110px;
            border-radius: 10px;
            background: #f5f0e8;
            border: 1px solid #e8e0d4;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            overflow: hidden;
            position: relative;
        }
        .book-cover-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 9px;
        }
        .book-cover-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            width: 100%;
            height: 100%;
        }
        .book-cover-placeholder i {
            font-size: 24px;
            color: #c4b8a8;
        }
        .book-cover-placeholder span {
            font-size: 8px;
            font-weight: 700;
            letter-spacing: 0.1em;
            color: #b8a89a;
        }
        .book-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .book-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 1.05rem;
            font-weight: 700;
            color: #1f2937;
            line-height: 1.3;
            margin-bottom: 4px;
        }
        .book-desc {
            font-size: 0.75rem;
            color: #6b7280;
            line-height: 1.4;
            margin-bottom: 2px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .book-author {
            font-size: 0.78rem;
            color: #9ca3af;
            margin-bottom: 10px;
        }

        /* Activity Badges */
        .activity-section {
            padding: 0 16px 14px;
        }
        .activity-label {
            font-size: 10px;
            font-weight: 600;
            color: #b8a89a;
            margin-bottom: 8px;
            letter-spacing: 0.02em;
        }
        .activity-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .activity-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            background: #f8f6f2;
            color: #4a5568;
            border: 1px solid #e8e0d4;
            transition: all 0.2s;
            cursor: pointer;
        }
        .activity-badge:hover {
            background: #FFF8F0;
            border-color: #FFE0B2;
            color: #FF9F43;
        }
        .activity-badge.done {
            background: rgba(16,185,129,0.08);
            border-color: rgba(16,185,129,0.2);
            color: #10b981;
        }
        .activity-badge i {
            font-size: 11px;
        }

        /* === Extra Books Section (ì¶”ì²œ + êµê³¼ì—°ê³„) === */
        .extra-books-section {
            padding: 0 16px 14px;
            border-top: 1px dashed #e8e0d4;
            margin-top: 2px;
        }
        .extra-books-label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 10px;
            font-weight: 600;
            color: #9ca3af;
            margin: 10px 0 8px;
            letter-spacing: 0.02em;
        }
        .extra-books-label i {
            font-size: 9px;
            color: #c4b8a8;
        }
        .extra-books-grid {
            display: flex;
            gap: 8px;
        }
        .extra-book-item {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 10px;
            background: #fafaf8;
            border: 1px solid #f0ebe3;
            border-radius: 10px;
            transition: all 0.2s;
            cursor: pointer;
        }
        .extra-book-item:hover {
            background: #fff8f0;
            border-color: #ffe0b2;
        }
        .extra-book-thumb {
            width: 32px;
            height: 40px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }
        .extra-book-thumb.recommend {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 1px solid #fcd34d;
        }
        .extra-book-thumb.curriculum {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border: 1px solid #93c5fd;
        }
        .extra-book-info {
            flex: 1;
            min-width: 0;
        }
        .extra-book-type {
            font-size: 9px;
            font-weight: 700;
            letter-spacing: 0.02em;
            margin-bottom: 1px;
        }
        .extra-book-type.recommend {
            color: #d97706;
        }
        .extra-book-type.curriculum {
            color: #2563eb;
        }
        .extra-book-title {
            font-size: 11px;
            font-weight: 600;
            color: #374151;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .extra-book-author {
            font-size: 9px;
            color: #9ca3af;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* ì ê¸´ ìƒíƒœì¼ ë•Œ ë¶€ê°€ ë„ì„œ íë¦¬ê²Œ */
        .week-card .extra-books-section.locked {
            opacity: 0.5;
            pointer-events: none;
        }

        /* === Reading Step Board (ã„¹ Path - Light Theme) === */
        .board-wrapper {
            background: linear-gradient(180deg, #FEF9F0 0%, #FFF6EA 50%, #FFF2E0 100%);
            min-height: 100vh;
            padding: 28px 16px 44px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            position: relative;
            overflow: hidden;
        }
        .board-wrapper::before {
            content: '';
            position: absolute;
            inset: 0;
            background:
                radial-gradient(circle at 15% 85%, rgba(255,159,67,0.06) 0%, transparent 50%),
                radial-gradient(circle at 85% 15%, rgba(139,92,246,0.04) 0%, transparent 50%);
            pointer-events: none;
        }

        .board-title {
            text-align: center;
            position: relative;
            z-index: 1;
        }
        .board-title h3 {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 25px;
            font-weight: 800;
            color: #2d1b0e;
        }
        .board-title p {
            font-size: 14px;
            color: #9ca3af;
            margin-top: 4px;
        }

        /* Summary Bar */
        .board-summary {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 24px;
            background: white;
            border-radius: 18px;
            border: 1px solid #f0ebe3;
            box-shadow: 0 2px 10px rgba(0,0,0,0.04);
            max-width: 720px;
            width: 100%;
            position: relative;
            z-index: 1;
        }
        .bs-item { display: flex; flex-direction: column; align-items: center; flex: 1; }
        .bs-num { font-family: 'Noto Sans KR', sans-serif; font-size: 1.5rem; font-weight: 800; line-height: 1; }
        .bs-label { font-size: 12px; color: #9ca3af; margin-top: 4px; }
        .bs-divider { width: 1px; height: 36px; background: #f0ebe3; }

        /* Board Frame */
        .board-frame {
            width: 100%;
            max-width: 720px;
            padding: 14px;
            background: white;
            border-radius: 24px;
            border: 1px solid #f0ebe3;
            box-shadow: 0 4px 24px rgba(0,0,0,0.06);
            position: relative;
            z-index: 1;
        }

        /* Grid - ã„¹ serpentine: 5 cols, 7 rows (all auto height) */
        .board-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(7, auto);
            gap: 6px;
        }

        /* Base Tile */
        .b-tile {
            border-radius: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px 6px 10px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
            overflow: visible;
            background: #f8f6f2;
            border: 1.5px solid #ebe5db;
            min-height: 96px;
        }
        .b-tile:hover {
            transform: scale(1.06) translateY(-2px);
            z-index: 5;
            box-shadow: 0 8px 28px rgba(0,0,0,0.1);
        }

        /* Color band (top of tile) */
        .b-tile .tile-band {
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 7px;
            border-radius: 14px 14px 0 0;
        }

        /* Tile content */
        .tile-lv {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 17px;
            font-weight: 800;
            color: #1f2937;
            line-height: 1.1;
            text-align: center;
            position: relative;
            z-index: 1;
            margin-top: 4px;
        }
        .tile-grade {
            font-size: 11px;
            color: #9ca3af;
            text-align: center;
            position: relative;
            z-index: 1;
            margin-top: 3px;
        }
        .tile-status-icon {
            font-size: 15px;
            margin-top: 4px;
            position: relative;
            z-index: 1;
        }

        /* Completed */
        .b-tile.st-completed { background: #f8f6f2; }
        .b-tile.st-completed .tile-lv { color: #374151; }
        .b-tile.st-completed .tile-status-icon { color: #10b981; }

        /* Current */
        .b-tile.st-current {
            background: linear-gradient(135deg, #FFF8F0, #FFE8CC);
            border: 3px solid #FF9F43;
            box-shadow: 0 0 16px rgba(255,159,67,0.25), 0 6px 16px rgba(255,159,67,0.15);
            animation: currentTileGlow 2s ease-in-out infinite;
        }
        .b-tile.st-current .tile-lv { color: #c2410c; font-size: 18px; }

        /* Locked */
        .b-tile.st-locked { background: #f5f3ef; border-color: #e8e4dc; opacity: 0.6; }
        .b-tile.st-locked .tile-lv { color: #b8b0a4; font-size: 15px; }
        .b-tile.st-locked .tile-grade { color: #c8c0b4; }

        /* Corner / Special Tiles */
        .b-tile.corner-tile {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2.5px solid #f59e0b;
        }
        .b-tile.start-tile {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border-color: #22c55e;
        }
        .b-tile.goal-tile {
            background: linear-gradient(135deg, #fef9c3, #fde047);
            border-color: #eab308;
        }
        .b-tile.island-tile {
            background: linear-gradient(135deg, #e0f2fe, #bae6fd);
            border-color: #0ea5e9;
        }
        .b-tile.key-tile {
            background: linear-gradient(135deg, #fce7f3, #fbcfe8);
            border-color: #ec4899;
        }
        .b-tile.bonus-tile {
            background: linear-gradient(135deg, #ede9fe, #ddd6fe);
            border-color: #8b5cf6;
        }
        .corner-icon { font-size: 28px; line-height: 1; }
        .corner-label {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 12px;
            font-weight: 800;
            color: #4a5568;
            margin-top: 4px;
        }

        /* Bridge Tile (ã„¹ connector between rows) */
        .b-bridge {
            border-radius: 14px;
            min-height: 72px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 3px;
            background: linear-gradient(135deg, #FFF8F0, #FFF0DD);
            border: 2.5px dashed #FFD4A0;
            cursor: default;
            position: relative;
        }
        .b-bridge i {
            color: #FF9F43;
            font-size: 22px;
        }
        .b-bridge .bridge-label {
            font-size: 10px;
            font-weight: 700;
            color: #d4a06a;
        }

        /* Avatar on current tile */
        .tile-avatar {
            position: absolute;
            top: -10px;
            right: -5px;
            width: 34px;
            height: 34px;
            background: linear-gradient(135deg, #FF9F43, #F368E0);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            border: 2.5px solid white;
            box-shadow: 0 3px 10px rgba(255,159,67,0.4);
            z-index: 3;
            animation: avatarBounce 1s ease-in-out infinite;
        }

        @keyframes currentTileGlow {
            0%, 100% { box-shadow: 0 0 16px rgba(255,159,67,0.25), 0 6px 16px rgba(255,159,67,0.15); }
            50% { box-shadow: 0 0 28px rgba(255,159,67,0.4), 0 6px 20px rgba(255,159,67,0.25); }
        }
        @keyframes avatarBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        /* Legend */
        .board-legend {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 16px;
            padding: 14px 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 16px;
            border: 1px solid #f0ebe3;
            max-width: 720px;
            width: 100%;
            position: relative;
            z-index: 1;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
        }
        .legend-dot {
            width: 11px;
            height: 11px;
            border-radius: 50%;
            border: 1.5px solid rgba(0,0,0,0.08);
        }

        /* Group color chips */
        .board-groups {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 10px;
            max-width: 720px;
            width: 100%;
            position: relative;
            z-index: 1;
        }
        .group-chip {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            background: rgba(255,255,255,0.8);
            border-radius: 10px;
            border: 1px solid #f0ebe3;
        }
        .group-dot {
            width: 11px;
            height: 11px;
            border-radius: 3px;
        }
        .group-name {
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
        }

        /* === Responsive === */
        @media (max-width: 768px) {
            main.flex-1 { padding-top: 4rem; }
            .month-title-text, .month-title-num { font-size: 1.1rem; }
            .header-brand-icon { width: 30px; height: 30px; font-size: 15px; border-radius: 8px; }
            .header-title { font-size: 14px; }
            .header-subtitle { font-size: 10px; }
            .header-level-badge { padding: 4px 10px; gap: 5px; }
            .header-level-badge .level-label { font-size: 11px; }
            .header-level-badge .level-bar { width: 44px; }
            .tab-pill { padding: 8px 14px; font-size: 13px; }
            .tab-pill .tab-emoji { font-size: 14px; }
            .week-card-body { gap: 10px; }
            .book-cover-box { width: 76px; height: 95px; }
            .book-title { font-size: 0.95rem; }
            .board-frame { max-width: 100%; padding: 8px; }
            .board-grid { gap: 4px; }
            .b-tile { border-radius: 10px; padding: 8px 4px 6px; min-height: 76px; }
            .b-bridge { min-height: 56px; }
            .tile-lv { font-size: 14px; }
            .tile-grade { font-size: 9px; }
            .tile-status-icon { font-size: 12px; }
            .corner-icon { font-size: 22px; }
            .corner-label { font-size: 10px; }
            .tile-avatar { width: 28px; height: 28px; font-size: 15px; top: -8px; right: -4px; }
            .board-summary { padding: 12px 16px; gap: 10px; }
            .bs-num { font-size: 1.25rem; }
        }
    </style>
</head>
<body class="bg-brand-bg font-sans text-gray-800 h-screen overflow-hidden">
    <button class="sidebar-toggle" id="sidebar-toggle-btn" onclick="toggleSidebar()">
        <i class="fa-solid fa-bars text-gray-600 text-lg"></i>
    </button>
    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

    <div class="flex w-full h-full">
        <div id="sidebar-container"></div>

        <main class="flex-1 h-full overflow-y-auto" id="main-scroll" style="scroll-behavior:smooth;">
            <!-- Sticky Header -->
            <div class="sticky top-0 z-20 library-header">
                <div class="px-5 md:px-8 pt-4 pb-4">
                    <!-- Row 1: Brand + Level -->
                    <div class="header-top-row">
                        <div class="header-brand">
                            <div class="header-brand-icon">ğŸ“–</div>
                            <div class="header-brand-text">
                                <div class="header-title">KRS ë¦¬ë”© í”„ë¡œê·¸ë¨</div>
                                <div class="header-subtitle">ìš°í¬ì˜ ë…ì„œ ì—¬ì •</div>
                            </div>
                        </div>
                        <div class="header-level-badge">
                            <span class="level-label">K2-2</span>
                            <div class="level-bar">
                                <div class="level-fill" style="width:42%"></div>
                            </div>
                            <span class="level-count"><span id="completed-count">10</span>/24</span>
                        </div>
                    </div>
                    <!-- Row 2: Tab Switcher -->
                    <div class="tab-switcher" id="view-switcher">
                        <button class="tab-pill active" id="tab-btn-tree" onclick="switchTab('tree')">
                            <span class="tab-emoji">ğŸŒ³</span>
                            <span>ë„ì„œê´€</span>
                        </button>
                        <button class="tab-pill" id="tab-btn-map" onclick="switchTab('map')">
                            <span class="tab-emoji">ğŸ‘£</span>
                            <span>ë¦¬ë”©ìŠ¤íƒ­</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- ======== TAB 1: KRS ë„ì„œê´€ (Month Cards) ======== -->
            <div class="tab-content active" id="tab-tree">
                <div class="px-5 md:px-8 pt-6 pb-8" id="month-container">
                    <!-- JS renders month sections -->
                </div>
            </div>

            <!-- ======== TAB 2: KRS ë¦¬ë”©ë§µ ======== -->
            <div class="tab-content" id="tab-map">
                <div class="board-wrapper" id="rmap-container">
                    <!-- JS renders board game map -->
                </div>
            </div>
        </main>
    </div>

    <div id="logout-modal-container"></div>
    <script src="../js/common.js"></script>
    <script src="../js/sidebar.js"></script>
    <script>
    // ============================================================
    //  MONTHLY DATA (6ê°œì›”)
    // ============================================================
    const monthlyData = [
        {
            month: 1, status: 'completed',
            weeks: [
                { week: 1, level: 'K2-1', title: 'ì˜¤ì¦ˆì˜ ë§ˆë²•ì‚¬', desc: 'íšŒì˜¤ë¦¬ë°”ëŒì— ë‚ ë ¤ê°„ ë„ë¡œì‹œì˜ ì‹ ë¹„ë¡œìš´ ëª¨í—˜ ì´ì•¼ê¸°', author: 'L. í”„ë­í¬ ë°”ì›€ ì›ì‘', img: '../img/book1.jpg', type: 'core', status: 'completed', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: true },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: true }
                ], extraBooks: [
                    { type: 'recommend', title: 'ì´ìƒí•œ ë‚˜ë¼ì˜ ì•¨ë¦¬ìŠ¤', author: 'ë£¨ì´ìŠ¤ ìºëŸ´' },
                    { type: 'curriculum', title: 'ë°”ëŒì˜ ì–¸ë•', author: 'êµ­ì–´ 2-1 ìˆ˜ë¡', subject: 'êµ­ì–´' }
                ]},
                { week: 2, level: 'K2-1', title: 'ì•½ì†ì€ ì¦ê±°ì›Œ', desc: 'ì•½ì†ê³¼ ê·œì¹™ì˜ ì†Œì¤‘í•¨ì„ ë°°ìš°ëŠ” ìƒí™œ ë™í™”', author: 'ë°•ì€ê²½ ê¸€', img: '../img/book2.jpg', type: 'managed', status: 'completed', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: true },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: true },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: true }
                ], extraBooks: [
                    { type: 'recommend', title: 'ì¹œêµ¬ ì‚¬ì´ ì¢‹ì€ ë§', author: 'ê¹€ì˜ì§„' },
                    { type: 'curriculum', title: 'ì‚¬ì´ì¢‹ì€ ìš°ë¦¬', author: 'í†µí•© 2-1 ìˆ˜ë¡', subject: 'í†µí•©' }
                ]},
                { week: 3, level: 'K2-1', title: 'ì˜¤ì¦ˆì˜ ë§ˆë²•ì‚¬', desc: 'íšŒì˜¤ë¦¬ë°”ëŒì— ë‚ ë ¤ê°„ ë„ë¡œì‹œì˜ ì‹ ë¹„ë¡œìš´ ëª¨í—˜ ì´ì•¼ê¸°', author: 'L. í”„ë­í¬ ë°”ì›€ ì›ì‘', img: '../img/book1.jpg', type: 'core', status: 'completed', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: true },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: true }
                ], extraBooks: [
                    { type: 'recommend', title: 'í”¼í„°íŒ¬', author: 'ì œì„ìŠ¤ ë°°ë¦¬' },
                    { type: 'curriculum', title: 'ìš©ê¸°ë¥¼ ë‚´ìš”', author: 'ë„ë• 2-1 ìˆ˜ë¡', subject: 'ë„ë•' }
                ]},
                { week: 4, level: 'K2-1', title: 'ì•½ì†ì€ ì¦ê±°ì›Œ', desc: 'ì•½ì†ê³¼ ê·œì¹™ì˜ ì†Œì¤‘í•¨ì„ ë°°ìš°ëŠ” ìƒí™œ ë™í™”', author: 'ë°•ì€ê²½ ê¸€', img: '../img/book2.jpg', type: 'managed', status: 'completed', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: true },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: true },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: true }
                ], extraBooks: [
                    { type: 'recommend', title: 'í–‰ë³µí•œ ì™•ì', author: 'ì˜¤ìŠ¤ì¹´ ì™€ì¼ë“œ' },
                    { type: 'curriculum', title: 'ë´„ì´ ì˜¤ë©´', author: 'êµ­ì–´ 2-1 ìˆ˜ë¡', subject: 'êµ­ì–´' }
                ]}
            ]
        },
        {
            month: 2, status: 'completed',
            weeks: [
                { week: 1, level: 'K2-1', title: 'ìˆ­ìˆ­ì´ì™€ ë‚˜', desc: 'íŠ¹ë³„í•œ ì¹œêµ¬ì™€ í•¨ê»˜ ìë¼ëŠ” ìš°ì • ì´ì•¼ê¸°', author: 'ì§€ìœ¤ê²½ ê¸€', img: '../img/book3.jpg', type: 'core', status: 'completed', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: true },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: true }
                ], extraBooks: [
                    { type: 'recommend', title: 'ê°•ì•„ì§€ ë˜¥', author: 'ê¶Œì •ìƒ' },
                    { type: 'curriculum', title: 'ë™ë¬¼ ì¹œêµ¬ë“¤', author: 'í†µí•© 2-1 ìˆ˜ë¡', subject: 'í†µí•©' }
                ]},
                { week: 2, level: 'K2-1', title: 'ë¹¨ê°„ë¨¸ë¦¬ ì•¤', desc: 'ìƒìƒë ¥ ë„˜ì¹˜ëŠ” ì†Œë…€ ì•¤ì˜ ì´ˆë¡ ì§€ë¶• ì§‘ ì´ì•¼ê¸°', author: 'ëª½ê³ ë©”ë¦¬ ì›ì‘', img: '../img/book4.jpg', type: 'managed', status: 'completed', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: true },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: true },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: true }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë¹„ë°€ì˜ í™”ì›', author: 'í”„ëœì‹œìŠ¤ ë²„ë„·' },
                    { type: 'curriculum', title: 'ìƒìƒì˜ ë‚˜ë˜', author: 'êµ­ì–´ 2-1 ìˆ˜ë¡', subject: 'êµ­ì–´' }
                ]},
                { week: 3, level: 'K2-1', title: 'ìˆ­ìˆ­ì´ì™€ ë‚˜', desc: 'íŠ¹ë³„í•œ ì¹œêµ¬ì™€ í•¨ê»˜ ìë¼ëŠ” ìš°ì • ì´ì•¼ê¸°', author: 'ì§€ìœ¤ê²½ ê¸€', img: '../img/book3.jpg', type: 'core', status: 'completed', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: true },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: true }
                ], extraBooks: [
                    { type: 'recommend', title: 'ê¹Œë§‰ëˆˆ ì‚¼ë””ê¸°', author: 'ì´ê¸ˆì´' },
                    { type: 'curriculum', title: 'ìƒëª…ì˜ ì†Œì¤‘í•¨', author: 'ë„ë• 2-1 ìˆ˜ë¡', subject: 'ë„ë•' }
                ]},
                { week: 4, level: 'K2-2', title: 'ë‚˜ë¬´ë¥¼ ì‹¬ì€ ì‚¬ëŒ', desc: 'í•œ ì‚¬ëŒì˜ ëˆê¸°ê°€ ìˆ²ì„ ë§Œë“  ê°ë™ ì‹¤í™”', author: 'ì¥ ì§€ì˜¤ë…¸ ì›ì‘', img: '', type: 'managed', status: 'completed', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: true },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: true },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: true }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë‚˜ë¬´ëŠ” ì¢‹ë‹¤', author: 'ì¬ë‹ˆìŠ¤ ë©”ì´ ìš°ë“œë¦¬' },
                    { type: 'curriculum', title: 'í™˜ê²½ê³¼ ìƒíƒœ', author: 'í†µí•© 2-2 ìˆ˜ë¡', subject: 'í†µí•©' }
                ]}
            ]
        },
        {
            month: 3, status: 'current',
            weeks: [
                { week: 1, level: 'K2-2', title: 'ì˜¤ì¦ˆì˜ ë§ˆë²•ì‚¬', desc: 'íšŒì˜¤ë¦¬ë°”ëŒì— ë‚ ë ¤ê°„ ë„ë¡œì‹œì˜ ì‹ ë¹„ë¡œìš´ ëª¨í—˜ ì´ì•¼ê¸°', author: 'L. í”„ë­í¬ ë°”ì›€ ì›ì‘', img: '../img/book1.jpg', type: 'core', status: 'in-progress', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë§ˆë²•ì˜ ì‹œê°„ì—¬í–‰', author: 'ë©”ë¦¬ í½ ì–´ìŠ¤ë³¸' },
                    { type: 'curriculum', title: 'ê¿ˆì„ í–¥í•´', author: 'êµ­ì–´ 2-2 ìˆ˜ë¡', subject: 'êµ­ì–´' }
                ]},
                { week: 2, level: 'K2-2', title: 'ì•½ì†ì€ ì¦ê±°ì›Œ', desc: 'ì•½ì†ê³¼ ê·œì¹™ì˜ ì†Œì¤‘í•¨ì„ ë°°ìš°ëŠ” ìƒí™œ ë™í™”', author: 'ë°•ì€ê²½ ê¸€', img: '../img/book2.jpg', type: 'managed', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ê´œì°®ì•„ ê´œì°®ì•„', author: 'ìµœìˆ™í¬' },
                    { type: 'curriculum', title: 'ë°”ë¥¸ ìƒí™œ', author: 'ë„ë• 2-2 ìˆ˜ë¡', subject: 'ë„ë•' }
                ]},
                { week: 3, level: 'K2-2', title: 'ìˆ­ìˆ­ì´ì™€ ë‚˜', desc: 'íŠ¹ë³„í•œ ì¹œêµ¬ì™€ í•¨ê»˜ ìë¼ëŠ” ìš°ì • ì´ì•¼ê¸°', author: 'ì§€ìœ¤ê²½ ê¸€', img: '../img/book3.jpg', type: 'core', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë‚´ ì¹œêµ¬ ê°œ', author: 'ì•ˆí† ë‹ˆ ë¸Œë¼ìš´' },
                    { type: 'curriculum', title: 'í•¨ê»˜ ì‚´ì•„ìš”', author: 'í†µí•© 2-2 ìˆ˜ë¡', subject: 'í†µí•©' }
                ]},
                { week: 4, level: 'K2-2', title: 'ë¹¨ê°„ë¨¸ë¦¬ ì•¤', desc: 'ìƒìƒë ¥ ë„˜ì¹˜ëŠ” ì†Œë…€ ì•¤ì˜ ì´ˆë¡ ì§€ë¶• ì§‘ ì´ì•¼ê¸°', author: 'ëª½ê³ ë©”ë¦¬ ì›ì‘', img: '../img/book4.jpg', type: 'managed', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'í‚¤ë‹¤ë¦¬ ì•„ì €ì”¨', author: 'ì§„ ì›¹ìŠ¤í„°' },
                    { type: 'curriculum', title: 'ì¸ë¬¼ì˜ ì‚¶', author: 'êµ­ì–´ 2-2 ìˆ˜ë¡', subject: 'êµ­ì–´' }
                ]}
            ]
        },
        {
            month: 4, status: 'locked',
            weeks: [
                { week: 1, level: 'K2-2', title: 'ê¿ˆê¾¸ëŠ” ë¡œë´‡', desc: 'ë¡œë´‡ê³¼ ì•„ì´ì˜ íŠ¹ë³„í•œ ìš°ì • ì´ì•¼ê¸°', author: 'ì´ì§€í˜„ ê¸€', img: '', type: 'core', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë¡œë´‡ ì¹œêµ¬ ì°¾ê¸°', author: 'ê¹€ì˜ì§„' },
                    { type: 'curriculum', title: 'ê³¼í•™ê³¼ ìƒí™œ', author: 'ê³¼í•™ 2-2 ìˆ˜ë¡', subject: 'ê³¼í•™' }
                ]},
                { week: 2, level: 'K2-2', title: 'ì‘ì€ ì˜ì›…', desc: 'í‰ë²”í•œ ì•„ì´ê°€ ìš©ê¸°ë¥¼ ë‚´ì–´ ì˜ì›…ì´ ë˜ëŠ” ì´ì•¼ê¸°', author: 'ê¹€íƒœì˜ ê¸€', img: '', type: 'managed', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ìš©ê¸° ìˆëŠ” ì•„ì´', author: 'ë°•í˜„ì£¼' },
                    { type: 'curriculum', title: 'ë‚˜ì˜ ê¿ˆ', author: 'ë„ë• 2-2 ìˆ˜ë¡', subject: 'ë„ë•' }
                ]},
                { week: 3, level: 'K2-2', title: 'ì‹ ë¹„í•œ ë™êµ´', desc: 'ë™êµ´ ì†ì—ì„œ ë°œê²¬í•œ ë†€ë¼ìš´ ë¹„ë°€ ëª¨í—˜', author: 'ë°•ì†Œì—° ê¸€', img: '', type: 'core', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë™êµ´ íƒí—˜ëŒ€', author: 'ìµœë¯¼ì„œ' },
                    { type: 'curriculum', title: 'ë•…ì†ì˜ ì„¸ê³„', author: 'ê³¼í•™ 2-2 ìˆ˜ë¡', subject: 'ê³¼í•™' }
                ]},
                { week: 4, level: 'K2-2', title: 'êµ¬ë¦„ ìœ„ì˜ ì„¸ìƒ', desc: 'êµ¬ë¦„ ìœ„ì—ì„œ í¼ì³ì§€ëŠ” í™˜ìƒì ì¸ í•˜ëŠ˜ ì—¬í–‰', author: 'ìµœì€ì˜ ê¸€', img: '', type: 'managed', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë‚ ì”¨ì˜ ë¹„ë°€', author: 'ì •í•˜ëŠ˜' },
                    { type: 'curriculum', title: 'í•˜ëŠ˜ê³¼ ë‚ ì”¨', author: 'ê³¼í•™ 2-2 ìˆ˜ë¡', subject: 'ê³¼í•™' }
                ]}
            ]
        },
        {
            month: 5, status: 'locked',
            weeks: [
                { week: 1, level: 'K3-1', title: 'ë¯¸ë˜ì˜ ë°œëª…ê°€', desc: 'ì‘ì€ ë°œëª…ìœ¼ë¡œ ì„¸ìƒì„ ë°”ê¾¸ëŠ” ê¿ˆ ì´ì•¼ê¸°', author: 'í•œì§€ì€ ê¸€', img: '', type: 'core', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ì—ë””ìŠ¨ ì´ì•¼ê¸°', author: 'ê³¼í•™ìœ„ì¸ì „' },
                    { type: 'curriculum', title: 'ë°œëª…ê³¼ ë°œê²¬', author: 'ê³¼í•™ 3-1 ìˆ˜ë¡', subject: 'ê³¼í•™' }
                ]},
                { week: 2, level: 'K3-1', title: 'ë°”ë‹¤ì˜ ë¹„ë°€', desc: 'ê¹Šì€ ë°”ë‹¤ ì† ìˆ¨ê²¨ì§„ ë³´ë¬¼ê³¼ ìƒë¬¼ì˜ ì„¸ê³„', author: 'ì•„ë†€ë“œ ë¡œë²¨', img: '', type: 'managed', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'í•´ì–‘ íƒí—˜ëŒ€', author: 'ì´ìˆ˜ë¯¼' },
                    { type: 'curriculum', title: 'ë°”ë‹¤ì™€ ìƒë¬¼', author: 'ê³¼í•™ 3-1 ìˆ˜ë¡', subject: 'ê³¼í•™' }
                ]},
                { week: 3, level: 'K3-1', title: 'ë³„ë¹› ë§ˆì„', author: 'ì˜¤ í—¨ë¦¬', desc: 'ë”°ëœ»í•œ ë§ˆìŒì´ ëª¨ì¸ ì‘ì€ ë§ˆì„ì˜ ì´ì•¼ê¸°', img: '', type: 'core', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ì‘ì€ ë§ˆì„ í° ê¿ˆ', author: 'ê¹€ì„œí˜„' },
                    { type: 'curriculum', title: 'ìš°ë¦¬ ë§ˆì„', author: 'ì‚¬íšŒ 3-1 ìˆ˜ë¡', subject: 'ì‚¬íšŒ' }
                ]},
                { week: 4, level: 'K3-1', title: 'í•˜ëŠ˜ì„ ë‚˜ëŠ” ê¿ˆ', desc: 'í•˜ëŠ˜ì„ ë™ê²½í•˜ëŠ” ì•„ì´ì˜ ì•„ë¦„ë‹¤ìš´ ê¿ˆ ì´ì•¼ê¸°', author: 'ìœ¤ë™ì£¼', img: '', type: 'managed', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë¼ì´íŠ¸ í˜•ì œ', author: 'ì„¸ê³„ìœ„ì¸ì „' },
                    { type: 'curriculum', title: 'ê¿ˆê³¼ í¬ë§', author: 'êµ­ì–´ 3-1 ìˆ˜ë¡', subject: 'êµ­ì–´' }
                ]}
            ]
        },
        {
            month: 6, status: 'locked',
            weeks: [
                { week: 1, level: 'K3-1', title: 'ì‹œê°„ ì—¬í–‰ì', desc: 'ê³¼ê±°ì™€ ë¯¸ë˜ë¥¼ ì˜¤ê°€ëŠ” ì‹ ë¹„ë¡œìš´ ì‹œê°„ ëª¨í—˜', author: 'ë§ˆë¥´ì¿ ìŠ¤ í”¼ìŠ¤í„°', img: '', type: 'core', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'íƒ€ì„ë¨¸ì‹ ', author: 'H.G. ì›°ìŠ¤' },
                    { type: 'curriculum', title: 'ì—­ì‚¬ ì† ì¸ë¬¼', author: 'ì‚¬íšŒ 3-1 ìˆ˜ë¡', subject: 'ì‚¬íšŒ' }
                ]},
                { week: 2, level: 'K3-1', title: 'ë§ˆë²•ì˜ ì •ì›', desc: 'ë¹„ë°€ ì •ì›ì—ì„œ í”¼ì–´ë‚˜ëŠ” ìì—°ê³¼ í¬ë§ì˜ ì´ì•¼ê¸°', author: 'ì¥ ì§€ì˜¤ë…¸', img: '', type: 'managed', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ë¹„ë°€ì˜ í™”ì›', author: 'ë²„ë„·' },
                    { type: 'curriculum', title: 'ì‹ë¬¼ì˜ ì„±ì¥', author: 'ê³¼í•™ 3-1 ìˆ˜ë¡', subject: 'ê³¼í•™' }
                ]},
                { week: 3, level: 'K3-1', title: 'ê³µë£¡ ëŒ€íƒí—˜', desc: 'ê³µë£¡ ì‹œëŒ€ë¡œ ë– ë‚˜ëŠ” ì§œë¦¿í•œ íƒí—˜ ì´ì•¼ê¸°', author: 'í•œì§€ì€ ê¸€', img: '', type: 'core', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ê³µë£¡ë°±ê³¼', author: 'ê³µë£¡ë°•ì‚¬' },
                    { type: 'curriculum', title: 'ì§€êµ¬ì˜ ì—­ì‚¬', author: 'ê³¼í•™ 3-1 ìˆ˜ë¡', subject: 'ê³¼í•™' }
                ]},
                { week: 4, level: 'K3-1', title: 'ìš°ì£¼ íƒí—˜ëŒ€', desc: 'ì‹ ë¹„ë¡œìš´ ìš°ì£¼ë¥¼ ëˆ„ë¹„ëŠ” ì–´ë¦°ì´ íƒí—˜ëŒ€ ì´ì•¼ê¸°', author: 'ì´ìˆ˜ì • ê¸€', img: '', type: 'managed', status: 'locked', activities: [
                    { name: 'ë…í›„í€´ì¦ˆ', icon: 'fa-solid fa-pen-fancy', done: false },
                    { name: 'AI ë¦¬í…”ë§', icon: 'fa-solid fa-microphone', done: false },
                    { name: 'ì–´íœ˜ì±Œë¦°ì§€', icon: 'fa-solid fa-puzzle-piece', done: false }
                ], extraBooks: [
                    { type: 'recommend', title: 'ìš°ì£¼ì˜ ì‹ ë¹„', author: 'ì¹¼ ì„¸ì´ê±´' },
                    { type: 'curriculum', title: 'íƒœì–‘ê³„ì™€ ë³„', author: 'ê³¼í•™ 3-1 ìˆ˜ë¡', subject: 'ê³¼í•™' }
                ]}
            ]
        }
    ];

    // ============================================================
    //  KRS Levels (for road map)
    // ============================================================
    const krsLevels = [
        { id:'PreK1',label:'PreK1',grade:'ë§Œ 4~5ì„¸',group:'ë…ì„œê¸°ì´ˆ',groupIcon:'ğŸŒ±',desc:'í•œê¸€ í•´ë“ ì§‘ì¤‘',status:'completed' },
        { id:'PreK2',label:'PreK2',grade:'ë§Œ 6ì„¸',group:'ë…ì„œê¸°ì´ˆ',groupIcon:'ğŸŒ±',desc:'ê¸€ ê²½í—˜ í™•ëŒ€',status:'completed' },
        { id:'K1-1',label:'K1-1',grade:'ì´ˆ1-1',group:'ë…ì„œ ìœ ì°½ì„±',groupIcon:'ğŸ“—',desc:'ìœ ì°½ì„± ê¸°ì´ˆ',status:'completed' },
        { id:'K1-2',label:'K1-2',grade:'ì´ˆ1-2',group:'ë…ì„œ ìœ ì°½ì„±',groupIcon:'ğŸ“—',desc:'ìœ ì°½ì„± í™•ë³´',status:'completed' },
        { id:'K2-1',label:'K2-1',grade:'ì´ˆ2-1',group:'ë…ì„œ ìœ ì°½ì„±',groupIcon:'ğŸ“—',desc:'êµê³¼ ì—°ê³„',status:'completed' },
        { id:'K2-2',label:'K2-2',grade:'ì´ˆ2-2',group:'ë…ì„œ ìˆ™ë‹¬',groupIcon:'ğŸ“™',desc:'ì§€ì‹ ì²´ê³„í™”',status:'current',booksRead:10 },
        { id:'K3-1',label:'K3-1',grade:'ì´ˆ3-1',group:'ë…ì„œ ìˆ™ë‹¬',groupIcon:'ğŸ“™',desc:'ì§€ì‹ ì²´ê³„í™”',status:'locked' },
        { id:'K3-2',label:'K3-2',grade:'ì´ˆ3-2',group:'ë…ì„œ ìˆ™ë‹¬',groupIcon:'ğŸ“™',desc:'ì§€ì‹ ì²´ê³„í™”',status:'locked' },
        { id:'K4',label:'K4',grade:'ì´ˆ4',group:'ë…ì„œ ì‹¬í™”',groupIcon:'ğŸ“•',desc:'ë¹„íŒì  ì´í•´',status:'locked' },
        { id:'K5',label:'K5',grade:'ì´ˆ5',group:'ë…ì„œ ì‹¬í™”',groupIcon:'ğŸ“•',desc:'ì‹¬í™” ë…í•´',status:'locked' },
        { id:'K6',label:'K6',grade:'ì´ˆ6',group:'ë…ì„œ ì‹¬í™”',groupIcon:'ğŸ“•',desc:'ì‹¬í™” ë…í•´',status:'locked' },
        { id:'K7',label:'K7',grade:'ì¤‘1',group:'ë…ì„œ ì‹¬í™”',groupIcon:'ğŸ“•',desc:'ì „ë¬¸ ë…í•´',status:'locked' },
        { id:'K8',label:'K8',grade:'ì¤‘2~ê³ 1',group:'ë…ì„œ í™•ì¥',groupIcon:'ğŸ“˜',desc:'ê³ ê¸‰ ë…í•´',status:'locked' },
        { id:'K9',label:'K9',grade:'ê³ 2~ëŒ€1',group:'ë…ì„œ í™•ì¥',groupIcon:'ğŸ“˜',desc:'í•™ìˆ  ì´í•´',status:'locked' },
        { id:'K10',label:'K10',grade:'ì„±ì¸',group:'ë…ì„œ í™•ì¥',groupIcon:'ğŸ“˜',desc:'ì „ë¬¸ ë…í•´',status:'locked' }
    ];
    const groupColors = {
        'ë…ì„œê¸°ì´ˆ':{bg:'bg-emerald-50',border:'border-emerald-200',text:'text-emerald-700'},
        'ë…ì„œ ìœ ì°½ì„±':{bg:'bg-sky-50',border:'border-sky-200',text:'text-sky-700'},
        'ë…ì„œ ìˆ™ë‹¬':{bg:'bg-amber-50',border:'border-amber-200',text:'text-amber-700'},
        'ë…ì„œ ì‹¬í™”':{bg:'bg-violet-50',border:'border-violet-200',text:'text-violet-700'},
        'ë…ì„œ í™•ì¥':{bg:'bg-indigo-50',border:'border-indigo-200',text:'text-indigo-700'}
    };

    // ============================================================
    //  TAB SWITCHING
    // ============================================================
    let currentTab = 'tree', mapRendered = false;

    function switchTab(tab) {
        if (currentTab === tab) return;
        currentTab = tab;

        // íƒ­ ë²„íŠ¼ ìƒíƒœ í† ê¸€
        document.getElementById('tab-btn-tree').classList.toggle('active', tab === 'tree');
        document.getElementById('tab-btn-map').classList.toggle('active', tab === 'map');

        // ì½˜í…ì¸  ì „í™˜
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.getElementById(tab === 'tree' ? 'tab-tree' : 'tab-map').classList.add('active');
        if (tab === 'map') {
            // ë§µ íƒ­: ì¦‰ì‹œ topìœ¼ë¡œ ì´ë™ í›„, í˜„ì¬ ìœ„ì¹˜ê¹Œì§€ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
            document.getElementById('main-scroll').scrollTo({ top: 0, behavior: 'instant' });
            if (!mapRendered) { renderRoadMap(); mapRendered = true; }
            // ë Œë”ë§ ì™„ë£Œ í›„ í˜„ì¬ ìœ„ì¹˜ë¡œ ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
            requestAnimationFrame(() => {
                setTimeout(() => {
                    const node = document.querySelector('.b-tile.st-current');
                    if (node) {
                        node.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }, 300);
            });
        } else {
            document.getElementById('main-scroll').scrollTo({ top: 0, behavior: 'smooth' });
        }
    }

    // ê¸°ì¡´ í˜¸ì¶œ í˜¸í™˜
    function toggleMapView() {
        switchTab(currentTab === 'tree' ? 'map' : 'tree');
    }

    // ============================================================
    //  RENDER MONTH SECTIONS
    // ============================================================
    function renderMonthSections() {
        const container = document.getElementById('month-container');
        let html = '';

        monthlyData.forEach(m => {
            const isCollapsed = m.status === 'completed';
            const statusBadge = m.status === 'completed'
                ? `<span class="month-completed-badge"><i class="fa-solid fa-circle-check"></i> í•™ìŠµ ì™„ë£Œ</span>`
                : m.status === 'current'
                ? `<span class="month-completed-badge" style="background:rgba(255,159,67,0.1); color:#FF9F43;"><i class="fa-solid fa-bolt"></i> ì§„í–‰ ì¤‘</span>`
                : '';

            const completedClass = m.status === 'completed' ? ' completed' : '';
            html += `
            <div class="month-section${completedClass}" data-month="${m.month}">
                <div class="month-header" onclick="toggleMonth(${m.month})">
                    <span class="month-title-num">${m.month}ê°œì›”</span>
                    ${statusBadge}
                    <div class="month-toggle ${isCollapsed ? 'collapsed' : ''}" id="toggle-${m.month}">
                        <i class="fa-solid fa-chevron-down"></i>
                    </div>
                </div>
                <div class="month-body ${isCollapsed ? 'collapsed' : ''}" id="body-${m.month}">
                    <div class="week-grid">
                        ${m.weeks.map(w => renderWeekCard(w)).join('')}
                    </div>
                </div>
            </div>`;
        });

        container.innerHTML = html;
    }

    function renderWeekCard(w) {
        // Status display
        let statusHtml = '';
        if (w.status === 'completed') {
            statusHtml = '<span class="week-status completed"><i class="fa-solid fa-circle-check"></i> í•™ìŠµ ì™„ë£Œ</span>';
        } else if (w.status === 'in-progress') {
            statusHtml = '<span class="week-status in-progress"><i class="fa-solid fa-spinner fa-spin"></i> ì§„í–‰ ì¤‘</span>';
        } else {
            statusHtml = '<span class="week-status locked"><i class="fa-solid fa-lock"></i> ì ê¹€</span>';
        }

        // Book cover
        let coverHtml = '';
        if (w.img) {
            coverHtml = `<img src="${w.img}" alt="${w.title}" onerror="this.parentNode.innerHTML='<div class=\\'book-cover-placeholder\\'><i class=\\'fa-solid fa-book-open\\'></i><span>READING TREE</span></div>'">`;
        } else {
            coverHtml = `<div class="book-cover-placeholder"><i class="fa-solid fa-book-open"></i><span>READING TREE</span></div>`;
        }

        // Activities
        const activitiesHtml = w.activities.map(a => {
            const doneClass = a.done ? 'done' : '';
            const doneIcon = a.done ? '<i class="fa-solid fa-check"></i>' : '';
            return `<span class="activity-badge ${doneClass}"><i class="${a.icon}"></i>${a.name}${doneIcon}</span>`;
        }).join('');

        // Extra Books (ì¶”ì²œ + êµê³¼ì—°ê³„)
        let extraBooksHtml = '';
        if (w.extraBooks && w.extraBooks.length > 0) {
            const lockedClass = w.status === 'locked' ? ' locked' : '';
            const booksHtml = w.extraBooks.map(b => {
                const typeClass = b.type === 'recommend' ? 'recommend' : 'curriculum';
                const typeLabel = b.type === 'recommend' ? 'ì¶”ì²œë„ì„œ' : 'êµê³¼ì—°ê³„';
                const emoji = b.type === 'recommend' ? 'â­' : 'ğŸ“˜';
                return `
                <div class="extra-book-item">
                    <div class="extra-book-thumb ${typeClass}">${emoji}</div>
                    <div class="extra-book-info">
                        <div class="extra-book-type ${typeClass}">${typeLabel}</div>
                        <div class="extra-book-title">${b.title}</div>
                        <div class="extra-book-author">${b.author}</div>
                    </div>
                </div>`;
            }).join('');

            extraBooksHtml = `
            <div class="extra-books-section${lockedClass}">
                <div class="extra-books-label"><i class="fa-solid fa-book-bookmark"></i>í•¨ê»˜ ì½ìœ¼ë©´ ì¢‹ì€ ì±…</div>
                <div class="extra-books-grid">
                    ${booksHtml}
                </div>
            </div>`;
        }

        const cardClass = w.status === 'in-progress' ? 'week-card in-progress' : 'week-card';

        return `
        <div class="${cardClass}">
            <div class="week-card-header">
                <div class="week-badge">
                    <span class="week-num">${w.week}ì£¼ì°¨</span>
                    <span class="week-level">${w.level}</span>
                </div>
                ${statusHtml}
            </div>
            <div class="week-card-body">
                <div class="book-cover-box">
                    ${coverHtml}
                </div>
                <div class="book-info">
                    <div class="book-title">${w.title}</div>
                    ${w.desc ? `<div class="book-desc">${w.desc}</div>` : ''}
                    <div class="book-author">${w.author}</div>
                </div>
            </div>
            <div class="activity-section">
                <div class="activity-label">í•™ìŠµ í™œë™</div>
                <div class="activity-badges">
                    ${activitiesHtml}
                </div>
            </div>
            ${extraBooksHtml}
        </div>`;
    }

    // ============================================================
    //  TOGGLE MONTH
    // ============================================================
    function toggleMonth(monthNum) {
        const body = document.getElementById('body-' + monthNum);
        const toggle = document.getElementById('toggle-' + monthNum);
        body.classList.toggle('collapsed');
        toggle.classList.toggle('collapsed');
    }

    // ============================================================
    //  ROAD MAP
    // ============================================================
    // Book Band ìƒ‰ìƒ (Oxford Reading Tree ì°¸ê³ )
    const bandColors = {
        'ë…ì„œê¸°ì´ˆ':  '#C084FC', // Lilac/Pink
        'ë…ì„œ ìœ ì°½ì„±': '#38BDF8', // Blue/Turquoise
        'ë…ì„œ ìˆ™ë‹¬':  '#FB923C', // Orange/Gold
        'ë…ì„œ ì‹¬í™”':  '#A78BFA', // Purple
        'ë…ì„œ í™•ì¥':  '#818CF8', // Indigo
    };

    function renderRoadMap() {
        const container = document.getElementById('rmap-container');
        const completed = krsLevels.filter(l => l.status === 'completed').length;
        const current = krsLevels.find(l => l.status === 'current');
        const total = krsLevels.length;

        // ã„¹ì ê²½ë¡œ: 5ì—´ Ã— 7í–‰
        // Row 1 (â†’): START, PreK1, PreK2, K1-1, K1-2
        //                                         â†“ bridge (col 5)
        // Row 2 (â†): K3-2, K3-1, K2-2â˜…, K2-1, ë…ì„œì„¬
        // â†“ bridge (col 1)
        // Row 3 (â†’): í™©ê¸ˆì—´ì‡ , K4, K5, K6, K7
        //                                   â†“ bridge (col 5)
        // Row 4 (â†): GOAL, K10, K9, K8, ë³´ë„ˆìŠ¤
        const boardTiles = [
            // Row 1 (â†’): grid-row 1
            { r:1, c:1, type:'special', id:'start', icon:'ğŸš€', label:'ì¶œë°œ', cls:'start-tile' },
            { r:1, c:2, type:'level', idx:0 },   // PreK1
            { r:1, c:3, type:'level', idx:1 },   // PreK2
            { r:1, c:4, type:'level', idx:2 },   // K1-1
            { r:1, c:5, type:'level', idx:3 },   // K1-2
            // Bridge (grid-row 2, col 5) - full-size connector
            { r:2, c:5, type:'bridge', dir:'down-left' },
            // Row 2 (â†): grid-row 3
            { r:3, c:5, type:'special', id:'island', icon:'ğŸï¸', label:'ë…ì„œì„¬', cls:'island-tile' },
            { r:3, c:4, type:'level', idx:4 },   // K2-1
            { r:3, c:3, type:'level', idx:5 },   // K2-2 (í˜„ì¬)
            { r:3, c:2, type:'level', idx:6 },   // K3-1
            { r:3, c:1, type:'level', idx:7 },   // K3-2
            // Bridge (grid-row 4, col 1)
            { r:4, c:1, type:'bridge', dir:'down-right' },
            // Row 3 (â†’): grid-row 5
            { r:5, c:1, type:'special', id:'key', icon:'ğŸ—ï¸', label:'í™©ê¸ˆì—´ì‡ ', cls:'key-tile' },
            { r:5, c:2, type:'level', idx:8 },   // K4
            { r:5, c:3, type:'level', idx:9 },   // K5
            { r:5, c:4, type:'level', idx:10 },  // K6
            { r:5, c:5, type:'level', idx:11 },  // K7
            // Bridge (grid-row 6, col 5)
            { r:6, c:5, type:'bridge', dir:'down-left' },
            // Row 4 (â†): grid-row 7
            { r:7, c:5, type:'special', id:'bonus', icon:'ğŸ', label:'ë³´ë„ˆìŠ¤', cls:'bonus-tile' },
            { r:7, c:4, type:'level', idx:12 },  // K8
            { r:7, c:3, type:'level', idx:13 },  // K9
            { r:7, c:2, type:'level', idx:14 },  // K10
            { r:7, c:1, type:'special', id:'goal', icon:'ğŸ†', label:'ì™„ì£¼', cls:'goal-tile' },
        ];

        let tilesHtml = '';

        boardTiles.forEach(t => {
            const pos = `grid-row:${t.r}; grid-column:${t.c};`;

            if (t.type === 'bridge') {
                const arrowIcon = t.dir === 'down-left' ? 'fa-arrow-turn-down' : 'fa-arrow-turn-down fa-flip-horizontal';
                tilesHtml += `
                <div class="b-bridge" style="${pos}">
                    <i class="fa-solid ${arrowIcon}"></i>
                </div>`;
            } else if (t.type === 'special') {
                tilesHtml += `
                <div class="b-tile corner-tile ${t.cls}" style="${pos}">
                    <div class="corner-icon">${t.icon}</div>
                    <div class="corner-label">${t.label}</div>
                </div>`;
            } else {
                const lv = krsLevels[t.idx];
                const bc = bandColors[lv.group] || '#9ca3af';
                const stClass = lv.status === 'completed' ? 'st-completed' : lv.status === 'current' ? 'st-current' : 'st-locked';

                let statusIcon = '';
                if (lv.status === 'completed') {
                    statusIcon = '<div class="tile-status-icon"><i class="fa-solid fa-circle-check"></i></div>';
                } else if (lv.status === 'locked') {
                    statusIcon = '<div class="tile-status-icon" style="color:#c8c0b4;"><i class="fa-solid fa-lock" style="font-size:9px;"></i></div>';
                }

                const avatar = lv.status === 'current' ? '<div class="tile-avatar">ğŸ¿ï¸</div>' : '';

                tilesHtml += `
                <div class="b-tile ${stClass}" style="${pos}">
                    <div class="tile-band" style="background:${bc};"></div>
                    ${avatar}
                    <div class="tile-lv">${lv.label}</div>
                    <div class="tile-grade">${lv.grade}</div>
                    ${statusIcon}
                </div>`;
            }
        });

        // ê·¸ë£¹ ìƒ‰ìƒ ì¹©
        const groupNames = Object.keys(bandColors);
        const groupChipsHtml = groupNames.map(g =>
            `<div class="group-chip"><div class="group-dot" style="background:${bandColors[g]};"></div><div class="group-name">${g}</div></div>`
        ).join('');

        container.innerHTML = `
        <div class="board-title">
            <h3>ğŸ‘Ÿ KRS ë¦¬ë”© ìŠ¤íƒ­</h3>
            <p>PreK1 ~ K10 Â· ì´ ${total}ë‹¨ê³„</p>
        </div>
        <div class="board-summary">
            <div class="bs-item">
                <div class="bs-num" style="color:#10b981;">${completed}</div>
                <div class="bs-label">ì™„ë£Œ ë‹¨ê³„</div>
            </div>
            <div class="bs-divider"></div>
            <div class="bs-item">
                <div class="bs-num" style="color:#FF9F43;">${current ? current.label : '-'}</div>
                <div class="bs-label">í˜„ì¬ ë‹¨ê³„</div>
            </div>
            <div class="bs-divider"></div>
            <div class="bs-item">
                <div class="bs-num" style="color:#94a3b8;">${total - completed - 1}</div>
                <div class="bs-label">ë‚¨ì€ ë‹¨ê³„</div>
            </div>
            <div class="bs-divider"></div>
            <div class="bs-item">
                <div class="bs-num" style="color:#8b5cf6;">${total}</div>
                <div class="bs-label">ì „ì²´</div>
            </div>
        </div>
        <div class="board-frame">
            <div class="board-grid">
                ${tilesHtml}
            </div>
        </div>
        <div class="board-legend">
            <div class="legend-item"><div class="legend-dot" style="background:#10b981;"></div>ì™„ë£Œ</div>
            <div class="legend-item"><div class="legend-dot" style="background:linear-gradient(135deg,#FF9F43,#F368E0);"></div>í˜„ì¬</div>
            <div class="legend-item"><div class="legend-dot" style="background:#b8b0a4;"></div>ì ê¹€</div>
            <div class="legend-item"><span style="font-size:11px;">ğŸš€</span>ì¶œë°œ</div>
            <div class="legend-item"><span style="font-size:11px;">ğŸ†</span>ì™„ì£¼</div>
        </div>
        <div class="board-groups">${groupChipsHtml}</div>`;
    }

    // ============================================================
    //  UTILS
    // ============================================================
    function openBookViewer() {
        sessionStorage.setItem('currentBook', JSON.stringify({ title:'ì˜¤ì¦ˆì˜ ë§ˆë²•ì‚¬', type:'ì½”ì–´ë¶', level:'K2-2', currentBookPage:1, totalPages:8, week:1 }));
        window.location.href = 'book-viewer.html';
    }

    // ============================================================
    //  INIT
    // ============================================================
    document.addEventListener('DOMContentLoaded', () => {
        loadSidebar('library');
        loadLogoutModal();
        renderMonthSections();
    });
    </script>
</body>
</html>
