<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶í´ëŸ½ 3.0 - ë¼ì´ë¸ŒëŸ¬ë¦¬</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            bg: '#FEF3C7', primary: '#FF9F43', dark: '#F368E0', secondary: '#54a0ff', green: '#1dd1a1', paper: '#FDFBF7',
                            report: { bg: '#F8FAFC', accent: '#4F46E5', dark: '#1E293B' },
                            tech: { dark: '#1e293b', purple: '#8b5cf6', blue: '#3b82f6', cyan: '#06b6d4' }
                        }
                    },
                    boxShadow: {
                        'soft': '0 10px 25px -5px rgba(0, 0, 0, 0.05)',
                        'floating': '0 20px 25px -5px rgba(255, 159, 67, 0.3)',
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/sidebar.css">
    <link rel="stylesheet" href="../css/responsive.css">

    <style>
        .font-jua { font-family: 'Jua', sans-serif; }

        /* === Level Tab Bar === */
        .level-tab-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 4px;
        }
        .level-tab-bar::-webkit-scrollbar { display: none; }
        .level-tab-bar { -ms-overflow-style: none; scrollbar-width: none; }

        .level-tab {
            flex-shrink: 0;
            padding: 8px 16px;
            border-radius: 9999px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
            background: white;
            color: #6b7280;
        }
        .level-tab:hover {
            border-color: #FF9F43;
            color: #FF9F43;
        }
        .level-tab.active {
            background: linear-gradient(135deg, #FF9F43 0%, #F368E0 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 15px rgba(255, 159, 67, 0.3);
            font-weight: 700;
        }

        /* === Category Grid (ë“€ì˜¤ë§ê³  ìŠ¤íƒ€ì¼) === */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            max-width: 1350px;
        }
        /* ë°˜ì‘í˜•: í™”ë©´ ì»¤ì§ˆìˆ˜ë¡ ì—´ ìˆ˜ ì¦ê°€, ì¹´ë“œ max í¬ê¸° ì œí•œ */
        @media (min-width: 860px) {
            .category-grid { grid-template-columns: repeat(4, 1fr); }
        }
        @media (min-width: 1100px) {
            .category-grid { grid-template-columns: repeat(5, 1fr); }
        }

        .category-card {
            background: var(--card-bg, linear-gradient(145deg, #FFFDF7, #FFF8EE));
            border-radius: 1.25rem;
            padding: 0;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            aspect-ratio: 1/1;
            max-width: 270px;
            border: 2px solid var(--card-border, #f0e6d6);
            box-shadow: 0 5px 0 var(--card-shadow, #e2d6c4);
            overflow: hidden;
        }
        .category-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 0 var(--card-shadow, #e2d6c4);
            border-color: var(--card-accent, #e2d6c4);
        }
        .category-card:active {
            transform: translateY(3px);
            box-shadow: 0 1px 0 var(--card-shadow, #e2d6c4);
        }

        /* ê¸°ìš¸ì–´ì§„ ì•„ì´ì½˜ ë°•ìŠ¤ */
        .category-card-icon-box {
            width: 64px; height: 64px;
            border-radius: 18px;
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem;
            transform: rotate(-8deg);
            transition: transform 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
            margin-top: 2px;
        }
        .category-card:hover .category-card-icon-box {
            transform: rotate(0deg) scale(1.1);
        }

        /* ì¹´ë“œ ë‚´ë¶€ ë ˆì´ì•„ì›ƒ */
        .category-card-inner {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 14px 10px;
            gap: 6px;
        }
        .category-card-title {
            font-family: 'Jua', sans-serif;
            font-size: 1.05rem;
            color: #4a3728;
            line-height: 1.2;
        }
        .category-card-tagline {
            font-size: 10.5px;
            color: #b08968;
            line-height: 1.3;
            font-weight: 600;
            letter-spacing: -0.01em;
        }

        /* ì¹´ë“œë³„ ì•„ì´ì½˜ ë°•ìŠ¤ ì»¬ëŸ¬ */
        .cat-lang      .category-card-icon-box { background: linear-gradient(135deg, #58CC02, #46a302); --card-accent: #58CC02; }
        .cat-social    .category-card-icon-box { background: linear-gradient(135deg, #FF9600, #e08500); --card-accent: #FF9600; }
        .cat-science   .category-card-icon-box { background: linear-gradient(135deg, #1CB0F6, #0e96d6); --card-accent: #1CB0F6; }
        .cat-art       .category-card-icon-box { background: linear-gradient(135deg, #FF4B4B, #e03c3c); --card-accent: #FF4B4B; }
        .cat-knowledge .category-card-icon-box { background: linear-gradient(135deg, #A560E8, #8f4cd0); --card-accent: #A560E8; }
        .cat-english   .category-card-icon-box { background: linear-gradient(135deg, #2B70C9, #1f5eae); --card-accent: #2B70C9; }
        .cat-audio     .category-card-icon-box { background: linear-gradient(135deg, #CE82FF, #b86de6); --card-accent: #CE82FF; }
        .cat-plus      .category-card-icon-box { background: linear-gradient(135deg, #FF86D0, #e670b8); --card-accent: #FF86D0; }
        .cat-textbook  .category-card-icon-box { background: linear-gradient(135deg, #4A90D9, #3a7bc0); --card-accent: #4A90D9; }
        .cat-kinder    .category-card-icon-box { background: linear-gradient(135deg, #FFB020, #e09a10); --card-accent: #FFB020; }
        .cat-subscribe .category-card-icon-box { background: linear-gradient(135deg, #78C800, #64aa00); --card-accent: #78C800; }
        .cat-app       .category-card-icon-box { background: linear-gradient(135deg, #00CD9C, #00b388); --card-accent: #00CD9C; }

        /* ì¹´ë“œë³„ ë¯¸ìƒ‰ ë°°ê²½ + í…Œë‘ë¦¬ + ê·¸ë¦¼ì (ê° accent ì»¬ëŸ¬ ê¸°ë°˜) */
        .cat-lang      { --card-accent: #58CC02; --card-bg: linear-gradient(145deg, #f5fce8, #eaf8d4); --card-border: #c8e6a0; --card-shadow: #b0d888; }
        .cat-social    { --card-accent: #FF9600; --card-bg: linear-gradient(145deg, #fff7ea, #ffeed4); --card-border: #ffd9a0; --card-shadow: #f0c480; }
        .cat-science   { --card-accent: #1CB0F6; --card-bg: linear-gradient(145deg, #edf7ff, #d9effe); --card-border: #a8d8f8; --card-shadow: #88c4e8; }
        .cat-art       { --card-accent: #FF4B4B; --card-bg: linear-gradient(145deg, #fff0f0, #ffe4e4); --card-border: #ffc0c0; --card-shadow: #f0a0a0; }
        .cat-knowledge { --card-accent: #A560E8; --card-bg: linear-gradient(145deg, #f6eefe, #eddefa); --card-border: #d4b8f0; --card-shadow: #c0a0e0; }
        .cat-english   { --card-accent: #2B70C9; --card-bg: linear-gradient(145deg, #eef4fc, #dce8f8); --card-border: #a8c8e8; --card-shadow: #90b4d8; }
        .cat-audio     { --card-accent: #CE82FF; --card-bg: linear-gradient(145deg, #f9f0ff, #f0e0fe); --card-border: #dcc0f8; --card-shadow: #c8a8e8; }
        .cat-plus      { --card-accent: #FF86D0; --card-bg: linear-gradient(145deg, #fff0f8, #ffe4f2); --card-border: #ffc0e0; --card-shadow: #f0a0cc; }
        .cat-textbook  { --card-accent: #4A90D9; --card-bg: linear-gradient(145deg, #eff5fc, #dfe9f6); --card-border: #aecce8; --card-shadow: #96b8d8; }
        .cat-kinder    { --card-accent: #FFB020; --card-bg: linear-gradient(145deg, #fff8e8, #fff0d0); --card-border: #ffd888; --card-shadow: #f0c468; }
        .cat-subscribe { --card-accent: #78C800; --card-bg: linear-gradient(145deg, #f2fbe6, #e6f6d0); --card-border: #c0e098; --card-shadow: #a8d078; }
        .cat-app       { --card-accent: #00CD9C; --card-bg: linear-gradient(145deg, #e8fcf5, #d4f6ea); --card-border: #98e8cc; --card-shadow: #78d8b8; }

        /* === Series Detail View (2ë‹¨ê³„: ì‹œë¦¬ì¦ˆ ëª©ë¡) === */
        .detail-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 0 20px;
        }
        .detail-back-btn {
            width: 36px; height: 36px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            background: white;
            border: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
            color: #6b7280;
        }
        .detail-back-btn:hover { background: #f9fafb; color: #1f2937; }
        .detail-title {
            font-family: 'Jua', sans-serif;
            font-size: 1.2rem;
            color: #1f2937;
        }
        .detail-desc {
            font-size: 12px;
            color: #9ca3af;
        }

        /* === Series List (ì„¸ë¡œ ëª©ë¡) === */
        .series-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .series-item {
            background: white;
            border-radius: 1rem;
            padding: 16px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            display: flex;
            align-items: center;
            gap: 14px;
        }
        .series-item:hover {
            border-color: #FFE0B2;
            box-shadow: 0 6px 16px rgba(0,0,0,0.06);
        }
        .series-item:active { transform: scale(0.98); }
        .series-item-icon {
            width: 48px; height: 48px;
            border-radius: 14px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        .series-item-info { flex: 1; min-width: 0; }
        .series-item-title {
            font-family: 'Jua', sans-serif;
            font-size: 0.95rem;
            color: #1f2937;
        }
        .series-item-meta {
            font-size: 11px;
            color: #9ca3af;
            margin-top: 2px;
        }
        .series-item-arrow {
            color: #d1d5db;
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        /* === Empty State === */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #9ca3af;
        }
        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* === View transitions === */
        .view-fade-in {
            animation: viewFadeIn 0.25s ease;
        }
        @keyframes viewFadeIn {
            from { opacity: 0; transform: translateX(10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .view-fade-back {
            animation: viewFadeBack 0.25s ease;
        }
        @keyframes viewFadeBack {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* === Series Tab Bar (ìƒì„¸ í˜ì´ì§€) === */
        .series-tab-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 4px;
        }
        .series-tab-bar::-webkit-scrollbar { display: none; }
        .series-tab-bar { -ms-overflow-style: none; scrollbar-width: none; }

        .series-tab {
            flex-shrink: 0;
            padding: 8px 16px;
            border-radius: 9999px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
            background: white;
            color: #6b7280;
        }
        .series-tab:hover {
            border-color: #FF9F43;
            color: #FF9F43;
        }
        .series-tab.active {
            background: linear-gradient(135deg, #FF9F43 0%, #F368E0 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 15px rgba(255, 159, 67, 0.3);
            font-weight: 700;
        }

        /* === Content Grid (ì½˜í…ì¸  ì¸ë„¤ì¼ ê·¸ë¦¬ë“œ) === */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 14px;
        }
        .content-card {
            background: white;
            border-radius: 1rem;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.25s ease;
            border: 1.5px solid transparent;
            box-shadow: 0 2px 10px rgba(0,0,0,0.04);
            max-width: 500px;
        }
        .content-card:hover {
            transform: translateY(-3px);
            border-color: #FFE0B2;
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
        }
        .content-card:active { transform: scale(0.97); }

        /* ì¸ë„¤ì¼ ì˜ì—­ */
        .content-thumb {
            position: relative;
            width: 100%;
            aspect-ratio: 3/4;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .content-thumb-emoji {
            font-size: 3rem;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        /* ì½˜í…ì¸  íƒ€ì… ë±ƒì§€ */
        .content-type-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            padding: 3px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.02em;
            backdrop-filter: blur(4px);
        }
        .badge-book { background: rgba(59,130,246,0.85); color: white; }
        .badge-video { background: rgba(239,68,68,0.85); color: white; }
        .badge-app { background: rgba(16,185,129,0.85); color: white; }
        .badge-audio { background: rgba(168,85,247,0.85); color: white; }

        /* í•˜ë‹¨ ì •ë³´ */
        .content-info {
            padding: 10px 12px 12px;
        }
        .content-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            color: #1f2937;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.3;
        }
        .content-meta {
            font-size: 11px;
            color: #9ca3af;
            margin-top: 3px;
        }

        /* === Mobile === */
        @media (max-width: 768px) {
            main.flex-1 { padding-top: 4rem; }
            .category-grid { grid-template-columns: repeat(3, 1fr); gap: 10px; max-width: none; }
            .category-card { max-width: none; }
            .category-card-inner { padding: 10px 6px; gap: 5px; }
            .category-card-icon-box { width: 52px; height: 52px; font-size: 1.6rem; border-radius: 14px; }
            .category-card-title { font-size: 0.82rem; }
            .category-card-tagline { font-size: 9.5px; }
            .series-item { padding: 14px 16px; }
            .series-item-icon { width: 42px; height: 42px; font-size: 1.3rem; }
            .content-grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; }
            .content-thumb-emoji { font-size: 2.4rem; }
            .content-info { padding: 8px 10px 10px; }
            .content-title { font-size: 0.75rem; }
        }
        @media (max-width: 480px) {
            .category-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body class="bg-brand-bg font-sans text-gray-800 h-screen overflow-hidden">
    <!-- Mobile hamburger -->
    <button class="sidebar-toggle" id="sidebar-toggle-btn" onclick="toggleSidebar()">
        <i class="fa-solid fa-bars text-gray-600 text-lg"></i>
    </button>
    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

    <div class="flex w-full h-full">
        <!-- Sidebar Container -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <main class="flex-1 h-full overflow-y-auto">
            <!-- Sticky Header -->
            <div class="sticky top-0 bg-brand-bg/95 backdrop-blur-sm z-20 border-b border-orange-100/50" id="sticky-header">
                <!-- Page Title -->
                <div class="px-6 md:px-10 pt-6 pb-4" id="header-title-area">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3" id="header-left">
                            <!-- ëª©ë¡ ëª¨ë“œ: ì±… ì•„ì´ì½˜ -->
                            <div class="w-10 h-10 bg-gradient-to-br from-brand-primary to-orange-500 rounded-xl flex items-center justify-center shadow-md" id="header-icon-library">
                                <i class="fa-solid fa-layer-group text-white text-lg"></i>
                            </div>
                            <!-- ìƒì„¸ ëª¨ë“œ: ë’¤ë¡œê°€ê¸° ë²„íŠ¼ (ìˆ¨ê¹€) -->
                            <button class="w-10 h-10 bg-white border border-gray-200 rounded-xl flex items-center justify-center shadow-sm cursor-pointer hover:bg-gray-50 transition-all hidden" id="header-back-btn" onclick="backToCategories()">
                                <i class="fa-solid fa-arrow-left text-gray-600 text-lg"></i>
                            </button>
                            <div>
                                <h2 class="font-jua text-xl md:text-2xl text-gray-800" id="header-title">ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>
                                <p class="text-xs text-gray-400" id="header-subtitle">ì „ì²´ ë„ì„œë¥¼ ë‹¨ê³„ë³„ë¡œ íƒìƒ‰í•´ë³´ì„¸ìš”</p>
                            </div>
                        </div>
                        <div class="relative hide-mobile">
                            <input type="text" placeholder="ì‹œë¦¬ì¦ˆ, ë„ì„œ ê²€ìƒ‰..." class="w-56 h-10 bg-white/80 border border-gray-200 rounded-xl px-4 pr-10 outline-none focus:border-brand-primary focus:bg-white transition-all text-sm">
                            <i class="fa-solid fa-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
                        </div>
                    </div>
                </div>

                <!-- Level Tabs (ëª©ë¡ ëª¨ë“œ) -->
                <div class="px-6 md:px-10 pb-4" id="level-tab-wrapper">
                    <div class="level-tab-bar" id="level-tab-bar">
                        <span class="text-sm text-gray-500 font-medium flex-shrink-0 mr-1">ë‹¨ê³„</span>
                        <button class="level-tab" data-level="lv1" onclick="switchLevel('lv1')">Lv.1</button>
                        <button class="level-tab active" data-level="lv2-4" onclick="switchLevel('lv2-4')">Lv.2~4</button>
                        <button class="level-tab" data-level="lv7" onclick="switchLevel('lv7')">Lv.7</button>
                        <button class="level-tab" data-level="lv7plus" onclick="switchLevel('lv7plus')">Lv.7 ì´ìƒ</button>
                        <span class="text-sm text-gray-500 font-medium flex-shrink-0 ml-3 mr-1">ë§ì¶¤</span>
                        <button class="level-tab" data-level="liked" onclick="switchLevel('liked')">ì°œí•œ ë„ì„œ</button>
                        <button class="level-tab" data-level="recent" onclick="switchLevel('recent')">ìµœê·¼ ë³¸ ë„ì„œ</button>
                    </div>
                </div>

                <!-- Series Tabs (ìƒì„¸ ëª¨ë“œ - ìˆ¨ê¹€) -->
                <div class="px-6 md:px-10 pb-4 hidden" id="series-tab-wrapper">
                    <div class="series-tab-bar" id="series-tab-bar">
                        <!-- JSì—ì„œ ë™ì ìœ¼ë¡œ ë Œë”ë§ -->
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="py-6 px-6 md:px-10" id="library-content">

                <!-- ===== ì¹´í…Œê³ ë¦¬ ê·¸ë¦¬ë“œ ë·° (1ë‹¨ê³„) ===== -->
                <div id="category-grid-view">
                    <div class="category-grid" id="category-grid">
                        <!-- JSì—ì„œ ë™ì ìœ¼ë¡œ ë Œë”ë§ -->
                    </div>
                </div>

                <!-- ===== ì½˜í…ì¸  ê·¸ë¦¬ë“œ ë·° (ì‹œë¦¬ì¦ˆ ë‚´ ì½˜í…ì¸ ) ===== -->
                <div id="book-list-view" class="hidden">
                    <div class="content-grid" id="content-grid">
                        <!-- JSì—ì„œ ë™ì ìœ¼ë¡œ ë Œë”ë§ -->
                    </div>
                </div>

                <!-- ===== Lv.7 / Lv.7+ placeholder ===== -->
                <div id="empty-lv7" class="hidden">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“š</div>
                        <h3 class="font-jua text-lg text-gray-500 mb-2">Lv.7 ë„ì„œ ì¤€ë¹„ ì¤‘</h3>
                        <p class="text-sm text-gray-400">ê³§ ì—…ë°ì´íŠ¸ë  ì˜ˆì •ì´ì—ìš”!</p>
                    </div>
                </div>
                <div id="empty-lv7plus" class="hidden">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“š</div>
                        <h3 class="font-jua text-lg text-gray-500 mb-2">Lv.7 ì´ìƒ ë„ì„œ ì¤€ë¹„ ì¤‘</h3>
                        <p class="text-sm text-gray-400">ê³§ ì—…ë°ì´íŠ¸ë  ì˜ˆì •ì´ì—ìš”!</p>
                    </div>
                </div>

                <!-- ===== ì°œí•œ ë„ì„œ ===== -->
                <div id="empty-liked" class="hidden">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ’›</div>
                        <h3 class="font-jua text-lg text-gray-500 mb-2">ì°œí•œ ë„ì„œê°€ ì—†ì–´ìš”</h3>
                        <p class="text-sm text-gray-400">ë§ˆìŒì— ë“œëŠ” ì±…ì— í•˜íŠ¸ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”!</p>
                    </div>
                </div>

                <!-- ===== ìµœê·¼ ë³¸ ë„ì„œ ===== -->
                <div id="empty-recent" class="hidden">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ•</div>
                        <h3 class="font-jua text-lg text-gray-500 mb-2">ìµœê·¼ ë³¸ ë„ì„œê°€ ì—†ì–´ìš”</h3>
                        <p class="text-sm text-gray-400">ë„ì„œë¥¼ ì½ìœ¼ë©´ ì—¬ê¸°ì— í‘œì‹œë¼ìš”!</p>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Logout Modal Container -->
    <div id="logout-modal-container"></div>

    <!-- Scripts -->
    <script src="../js/common.js"></script>
    <script src="../js/sidebar.js"></script>
    <script>
        // ===== ì½˜í…ì¸  íƒ€ì… ì •ì˜ =====
        const contentTypes = {
            book:  { label: 'ë„ì„œ', badge: 'badge-book', icon: 'fa-solid fa-book' },
            video: { label: 'ì˜ìƒ', badge: 'badge-video', icon: 'fa-solid fa-play' },
            app:   { label: 'ì•±',   badge: 'badge-app',   icon: 'fa-solid fa-mobile-screen' },
            audio: { label: 'ìŒì›', badge: 'badge-audio', icon: 'fa-solid fa-headphones' }
        };

        // ===== ìƒ˜í”Œ ì½˜í…ì¸  ë°ì´í„° ìƒì„± í•¨ìˆ˜ =====
        function generateContents(seriesTitle, count) {
            const items = [];
            const thumbBgs = [
                'bg-sky-100','bg-amber-100','bg-pink-100','bg-emerald-100','bg-violet-100',
                'bg-rose-100','bg-cyan-100','bg-lime-100','bg-indigo-100','bg-orange-100',
                'bg-blue-100','bg-yellow-100','bg-fuchsia-100','bg-teal-100','bg-red-100'
            ];
            const coverEmojis = [
                'ğŸ“•','ğŸ“—','ğŸ“˜','ğŸ“™','ğŸ““','ğŸ¦Š','ğŸ»','ğŸ°','ğŸ¦','ğŸ¸',
                'ğŸŒ³','ğŸ ','ğŸš€','ğŸª','â›µ','ğŸ¦‹','ğŸŒ»','ğŸ','ğŸˆ','ğŸŒˆ',
                'ğŸ£','ğŸ¦„','ğŸ³','ğŸ©','ğŸŒº'
            ];
            // ì½˜í…ì¸  íƒ€ì… íŒ¨í„´: ëŒ€ë¶€ë¶„ ë„ì„œ, ì¤‘ê°„ì— ì˜ìƒ/ì•± ì„ê¸°
            const typePattern = [];
            for (let i = 0; i < count; i++) {
                if (i % 8 === 5) typePattern.push('video');
                else if (i % 12 === 9) typePattern.push('app');
                else if (i % 10 === 7) typePattern.push('audio');
                else typePattern.push('book');
            }

            for (let i = 0; i < count; i++) {
                const type = typePattern[i];
                let title;
                if (type === 'book') title = `${seriesTitle} ${items.filter(x => x.type==='book').length + 1}ê¶Œ`;
                else if (type === 'video') title = `${seriesTitle} ì˜ìƒ`;
                else if (type === 'app') title = `${seriesTitle} í™œë™`;
                else title = `${seriesTitle} ìŒì›`;

                items.push({
                    id: `content-${i + 1}`,
                    type: type,
                    title: title,
                    emoji: coverEmojis[i % coverEmojis.length],
                    bg: thumbBgs[i % thumbBgs.length]
                });
            }
            return items;
        }

        // ===== ì¹´í…Œê³ ë¦¬ & ì‹œë¦¬ì¦ˆ ë°ì´í„° =====
        const libraryData = {
            'lv1': [
                {
                    id: 'lang', title: 'ì–¸ì–´', desc: 'ë§í•˜ê¸° Â· ë“£ê¸° Â· ì½ê¸°',
                    icon: 'ğŸ—£ï¸', iconBg: 'bg-sky-100',
                    series: [
                        { id: 'talk-play', title: 'ì˜¹ì•Œì¢…ì•Œ ë§ë†€ì´', emoji: 'ğŸ—£ï¸', bg: 'bg-sky-100', meta: 'ì „ 20ê¶Œ' },
                        { id: 'hello-book', title: 'ê·¸ë¦¼ì±… ì•ˆë…•?', emoji: 'ğŸ“–', bg: 'bg-cyan-100', meta: 'ì „ 15ê¶Œ' }
                    ]
                },
                {
                    id: 'social', title: 'ì‚¬íšŒ', desc: 'ì„±ì¥ Â· ê°ì • Â· ê´€ê³„',
                    icon: 'ğŸŒ±', iconBg: 'bg-amber-100',
                    series: [
                        { id: 'growing-up', title: 'ë‚˜ëŠ” ìë¼ìš”!', emoji: 'ğŸŒ±', bg: 'bg-amber-100', meta: 'ì „ 18ê¶Œ' },
                        { id: 'how-feel', title: 'ë§ˆìŒì´ ì–´ë•Œ?', emoji: 'ğŸ’›', bg: 'bg-yellow-100', meta: 'ì „ 16ê¶Œ' }
                    ]
                },
                {
                    id: 'science', title: 'ìˆ˜Â·ê³¼í•™', desc: 'ìì—° Â· ìˆ˜í•™ Â· ê³¼í•™ íƒêµ¬',
                    icon: 'ğŸ”¬', iconBg: 'bg-emerald-100',
                    series: [
                        { id: 'great-nature', title: 'ìœ„ëŒ€í•´! ìì—°', emoji: 'ğŸŒ¿', bg: 'bg-emerald-100', meta: 'ì „ 20ê¶Œ' },
                        { id: 'great-science', title: 'ìœ„ëŒ€í•´! ìˆ˜ê³¼í•™', emoji: 'ğŸ”¬', bg: 'bg-teal-100', meta: 'ì „ 20ê¶Œ' }
                    ]
                },
                {
                    id: 'art', title: 'ì˜ˆìˆ Â·ë¬¸í™”', desc: 'ë¯¸ìˆ  Â· ìŒì•… Â· ì‹ ì²´ í™œë™',
                    icon: 'ğŸ¨', iconBg: 'bg-pink-100',
                    series: [
                        { id: 'art-play', title: 'ì•Œë¡ë‹¬ë¡ ì˜ˆìˆ ë†€ì´', emoji: 'ğŸ¨', bg: 'bg-pink-100', meta: 'ì „ 12ê¶Œ' },
                        { id: 'body-play', title: 'ì‹ ë‚˜ëŠ” ëª¸ë†€ì´', emoji: 'ğŸ¤¸', bg: 'bg-fuchsia-100', meta: 'ì „ 10ê¶Œ' }
                    ]
                },
                {
                    id: 'knowledge', title: 'ì¸ì§€Â·ì§€ì‹', desc: 'ê°ê° Â· ì‚¬ê³ ë ¥ Â· ì§€ì‹',
                    icon: 'ğŸ‘€', iconBg: 'bg-violet-100',
                    series: [
                        { id: 'open-sense', title: 'ì—´ë ¤ë¼! ê°ê°', emoji: 'ğŸ‘€', bg: 'bg-violet-100', meta: 'ì „ 14ê¶Œ' },
                        { id: 'fun-today', title: 'ì˜¤ëŠ˜ë„ ì¦ê±°ì›Œ!', emoji: 'ğŸ‰', bg: 'bg-indigo-100', meta: 'ì „ 16ê¶Œ' }
                    ]
                },
                {
                    id: 'english', title: 'ì˜ì–´', desc: 'ë…¸ë˜ Â· ì˜ìƒ Â· ìŠ¤í† ë¦¬ë¶',
                    icon: 'ğŸŒ', iconBg: 'bg-red-100',
                    series: [
                        { id: 'songs', title: 'Songs', emoji: 'ğŸµ', bg: 'bg-red-100', meta: 'ì „ 30ê³¡' },
                        { id: 'animations', title: 'Animations', emoji: 'ğŸ¬', bg: 'bg-orange-100', meta: 'ì „ 24í¸' },
                        { id: 'storybooks', title: 'Storybooks', emoji: 'ğŸ“š', bg: 'bg-rose-100', meta: 'ì „ 20ê¶Œ' }
                    ]
                },
                {
                    id: 'audio', title: 'ìŒì›', desc: 'ë™ìš” Â· ìŒì•… ê°ìƒ',
                    icon: 'ğŸ¶', iconBg: 'bg-lime-100',
                    series: [
                        { id: 'listen-songs', title: 'ë“¤ì–´ ë´! ë™ìš”', emoji: 'ğŸ¶', bg: 'bg-lime-100', meta: 'ì „ 40ê³¡' }
                    ]
                },
                {
                    id: 'plus', title: 'í”ŒëŸ¬ìŠ¤', desc: 'ì¶”ê°€ ì½˜í…ì¸  Â· ì¸í„°ë ‰í‹°ë¸Œ',
                    icon: 'ğŸ§¸', iconBg: 'bg-orange-100',
                    series: [
                        { id: 'bear-baby', title: 'ê³°ëŒì´ ë² ì´ë¹„', emoji: 'ğŸ§¸', bg: 'bg-orange-100', meta: 'ì „ 12ê¶Œ' },
                        { id: 'interactive-book', title: 'ì¸í„°ë ‰í‹°ë¸Œë¶', emoji: 'ğŸ‘†', bg: 'bg-yellow-100', meta: 'ì „ 10ê¶Œ' }
                    ]
                }
            ],
            'lv2-4': [
                {
                    id: 'lang', title: 'ì–¸ì–´', desc: 'í•œê¸€ Â· í•œì Â· ì´ì•¼ê¸°',
                    icon: 'ğŸ—£ï¸', iconBg: 'bg-sky-100',
                    series: [
                        { id: 'ganada', title: 'ê°€ë‚˜ë‹¤ í•œê¸€', emoji: 'ğŸ”¤', bg: 'bg-sky-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'hanja-play', title: 'í•œì ë†€ì´', emoji: 'ğŸ€„', bg: 'bg-amber-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'old-story', title: 'ì˜›ì´ì•¼ê¸° ì†”ì†”', emoji: 'ğŸ“œ', bg: 'bg-orange-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'world-classic', title: 'ì„¸ê³„ëª…ì‘ ê·¸ë¦¼ì±…', emoji: 'ğŸŒ', bg: 'bg-indigo-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'story-picture', title: 'ì´ì•¼ê¸° ê·¸ë¦¼ì±…', emoji: 'ğŸ“–', bg: 'bg-cyan-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'social', title: 'ì‚¬íšŒ', desc: 'ì§ì—… Â· ì—­ì‚¬ Â· ì¸ë¬¼ Â· ê°ì •',
                    icon: 'ğŸŒ±', iconBg: 'bg-amber-100',
                    series: [
                        { id: 'place-job', title: 'ë³„ë³„ ì¥ì†Œì™€ ì§ì—…', emoji: 'ğŸ¢', bg: 'bg-amber-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'into-history', title: 'ì—­ì‚¬ ì†ìœ¼ë¡œ', emoji: 'ğŸ›ï¸', bg: 'bg-yellow-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'great-people', title: 'ëŒ€ë‹¨í•´! ì¸ë¬¼', emoji: 'ğŸ‘¤', bg: 'bg-rose-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'how-feel-2', title: 'ë§ˆìŒì´ ì–´ë•Œ?', emoji: 'ğŸ’›', bg: 'bg-pink-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'diverse-world', title: 'ë‹¤ì–‘í•œ ì„¸ìƒ', emoji: 'ğŸŒ', bg: 'bg-violet-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'science', title: 'ìˆ˜Â·ê³¼í•™', desc: 'ìì—° Â· ê³¼í•™ Â· ìˆ˜í•™ Â· ì½”ë”©',
                    icon: 'ğŸ”¬', iconBg: 'bg-emerald-100',
                    series: [
                        { id: 'great-nature-2', title: 'ìœ„ëŒ€í•´! ìì—°', emoji: 'ğŸŒ¿', bg: 'bg-emerald-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'amazing-science', title: 'ì‹ ê¸°í•´! ê³¼í•™', emoji: 'ğŸ”¬', bg: 'bg-teal-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: '123-number', title: '1,2,3 ìˆ«ì', emoji: 'ğŸ”¢', bg: 'bg-blue-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'coding', title: 'ìš”ë¦¬ì¡°ë¦¬ ì½”ë”©', emoji: 'ğŸ’»', bg: 'bg-purple-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'facto-math', title: 'ì°½ì˜ì‚¬ê³ ë ¥ ìˆ˜í•™ íŒ©í† ', emoji: 'ğŸ§®', bg: 'bg-indigo-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'art', title: 'ì˜ˆìˆ Â·ë¬¸í™”', desc: 'ë™ìš” Â· ë¯¸ìˆ  Â· ì²´ìœ¡ Â· ì•ˆì „ Â· ë§Œë“¤ê¸°',
                    icon: 'ğŸ¨', iconBg: 'bg-pink-100',
                    series: [
                        { id: 'lalala-song', title: 'ë„ë„ë¼ ë™ìš”', emoji: 'ğŸµ', bg: 'bg-pink-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'love-art', title: 'ë¯¸ìˆ ì´ ì¢‹ì•„!', emoji: 'ğŸ¨', bg: 'bg-fuchsia-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'sports', title: 'ì­ˆìš± ì²´ìœ¡', emoji: 'ğŸ¤¸', bg: 'bg-lime-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'safety', title: 'ì¡°ì‹¬ì¡°ì‹¬ ì•ˆì „', emoji: 'âš ï¸', bg: 'bg-red-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'make-things', title: 'ì¡°ë¬¼ì¡°ë¬¼ ë§Œë“¤ê¸°', emoji: 'âœ‚ï¸', bg: 'bg-orange-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'knowledge', title: 'ì¸ì§€Â·ì§€ì‹', desc: 'ì§€ì‹ë°±ê³¼ Â· ìƒí™œ ìŠµê´€',
                    icon: 'ğŸ‘€', iconBg: 'bg-violet-100',
                    series: [
                        { id: 'encyclopedia', title: 'ê¶ê¸ˆí•´! ì§€ì‹ë°±ê³¼', emoji: 'ğŸ“š', bg: 'bg-violet-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'self-habit', title: 'ìŠ¤ìŠ¤ë¡œ ìƒí™œ ìŠµê´€', emoji: 'âœ…', bg: 'bg-green-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'english', title: 'ì˜ì–´', desc: 'ë…¸ë˜ Â· ì˜ìƒ Â· ìŠ¤í† ë¦¬ë¶ Â· ë¦¬ë”ìŠ¤ Â· ì•¡í‹°ë¹„í‹°',
                    icon: 'ğŸŒ', iconBg: 'bg-red-100',
                    series: [
                        { id: 'eng-songs', title: 'Songs', emoji: 'ğŸµ', bg: 'bg-red-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'eng-animations', title: 'Animations', emoji: 'ğŸ¬', bg: 'bg-orange-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'eng-storybooks', title: 'Storybooks', emoji: 'ğŸ“š', bg: 'bg-rose-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'eng-readers', title: 'Readers', emoji: 'ğŸ“–', bg: 'bg-sky-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'eng-activities', title: 'Activities', emoji: 'âœï¸', bg: 'bg-yellow-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'audio', title: 'ìŒì›', desc: 'ë™ìš” Â· ë™í™”',
                    icon: 'ğŸ¶', iconBg: 'bg-lime-100',
                    series: [
                        { id: 'listen-songs-2', title: 'ë“¤ì–´ ë´! ë™ìš”', emoji: 'ğŸ¶', bg: 'bg-lime-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'listen-story', title: 'ë“¤ì–´ ë´! ë™í™”', emoji: 'ğŸ§', bg: 'bg-emerald-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'textbook', title: 'êµê³¼', desc: 'ëˆ„ë¦¬ê³¼ì • ë‹¨ê³„ë³„ í•™ìŠµ',
                    icon: 'ğŸ“˜', iconBg: 'bg-blue-100',
                    series: [
                        { id: 'nuri-1', title: 'ëˆ„ë¦¬ 1ë‹¨ê³„', emoji: 'ğŸ“˜', bg: 'bg-blue-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'nuri-2', title: 'ëˆ„ë¦¬ 2ë‹¨ê³„', emoji: 'ğŸ“—', bg: 'bg-indigo-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'nuri-3', title: 'ëˆ„ë¦¬ 3ë‹¨ê³„', emoji: 'ğŸ“™', bg: 'bg-violet-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'kinder', title: 'í‚¨ë”', desc: 'ì•ˆì „ Â· ì˜ì‚¬ì†Œí†µ Â· ì‚¬íšŒ Â· ìì—° Â· ì˜ˆìˆ  Â· ì‹ ì²´',
                    icon: 'ğŸ§’', iconBg: 'bg-amber-100',
                    series: [
                        { id: 'kinder-safety', title: 'ì•ˆì „ìƒí™œ ìŠµê´€', emoji: 'ğŸ›¡ï¸', bg: 'bg-red-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'kinder-comm', title: 'ì˜ì‚¬ì†Œí†µ', emoji: 'ğŸ’¬', bg: 'bg-sky-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'kinder-social', title: 'ì‚¬íšŒê´€ê³„', emoji: 'ğŸ¤', bg: 'bg-amber-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'kinder-nature', title: 'ìì—°íƒêµ¬', emoji: 'ğŸ”', bg: 'bg-emerald-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'kinder-art', title: 'ì˜ˆìˆ ê²½í—˜', emoji: 'ğŸ­', bg: 'bg-pink-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'kinder-body', title: 'ì‹ ì²´ìš´ë™ê±´ê°•', emoji: 'ğŸƒ', bg: 'bg-lime-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'subscribe', title: 'ì „ì§‘êµ¬ë…', desc: 'êµ¬ë…í˜• ì „ì§‘ ì½˜í…ì¸ ',
                    icon: 'ğŸ“¦', iconBg: 'bg-yellow-100',
                    series: [
                        { id: 'subscribe-book', title: 'ì±…ë‹¤ë¥¸ êµ¬ë…', emoji: 'ğŸ“¦', bg: 'bg-yellow-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'plus', title: 'í”ŒëŸ¬ìŠ¤', desc: 'ì¶”ê°€ ì½˜í…ì¸  Â· AR Â· ì¸í„°ë ‰í‹°ë¸Œ',
                    icon: 'ğŸ§¸', iconBg: 'bg-orange-100',
                    series: [
                        { id: 'bear-kinder', title: 'ê³°ëŒì´ í‚¨ë”', emoji: 'ğŸ§¸', bg: 'bg-orange-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'bear-school', title: 'ê³°ëŒì´ ìŠ¤ì¿¨', emoji: 'ğŸ’', bg: 'bg-amber-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'creative-art', title: 'ì°½ì˜ì•„íŠ¸ê¹¨ì¹˜ì§€', emoji: 'ğŸ¨', bg: 'bg-pink-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'science-explore', title: 'ê³¼í•™íƒêµ¬', emoji: 'ğŸ§ª', bg: 'bg-teal-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'old-tales', title: 'ì˜¤ë¡±ë„ë¡œë¡± ì˜›ì´ì•¼ê¸°', emoji: 'ğŸ®', bg: 'bg-yellow-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'imagine-molang', title: 'ìƒìƒëª°ë‘', emoji: 'â˜ï¸', bg: 'bg-sky-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'friend-maisy', title: 'ë‚´ ì¹œêµ¬ ë©”ì´ì§€', emoji: 'ğŸ­', bg: 'bg-rose-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'arpedia', title: 'ARpedia', emoji: 'ğŸ“±', bg: 'bg-indigo-100', meta: 'ì‹œë¦¬ì¦ˆ' },
                        { id: 'ar-science', title: 'AR Science', emoji: 'ğŸ”­', bg: 'bg-cyan-100', meta: 'ì‹œë¦¬ì¦ˆ' }
                    ]
                },
                {
                    id: 'app', title: 'ì¶”ì²œì•±', desc: 'í•™ìŠµ ì•± ë‹¤ìš´ë¡œë“œ',
                    icon: 'ğŸ“²', iconBg: 'bg-green-100',
                    series: [
                        { id: 'app-download', title: 'ì•± ë‹¤ìš´ë¡œë“œ', emoji: 'ğŸ“²', bg: 'bg-green-100', meta: 'ë°”ë¡œê°€ê¸°' }
                    ]
                }
            ]
        };

        // ===== State =====
        let currentLevel = 'lv2-4';      // ë””í´íŠ¸: Lv.2~4
        let currentView = 'grid';         // 'grid' or 'detail'
        let currentCategory = null;       // í˜„ì¬ ì„ íƒëœ ì¹´í…Œê³ ë¦¬
        let currentSeriesIndex = 0;       // í˜„ì¬ ì„ íƒëœ ì‹œë¦¬ì¦ˆ íƒ­ ì¸ë±ìŠ¤

        // ===== í—¤ë” ëª¨ë“œ ì „í™˜ =====
        function setHeaderMode(mode, catTitle) {
            const iconLibrary = document.getElementById('header-icon-library');
            const backBtn = document.getElementById('header-back-btn');
            const title = document.getElementById('header-title');
            const subtitle = document.getElementById('header-subtitle');
            const levelTabWrapper = document.getElementById('level-tab-wrapper');
            const seriesTabWrapper = document.getElementById('series-tab-wrapper');

            if (mode === 'detail') {
                // ìƒì„¸ ëª¨ë“œ: ë’¤ë¡œê°€ê¸° + ë¸Œë ˆë“œí¬ëŸ¼ + ì‹œë¦¬ì¦ˆ íƒ­
                iconLibrary.classList.add('hidden');
                backBtn.classList.remove('hidden');
                title.innerHTML = `<span class="text-gray-400">ë¼ì´ë¸ŒëŸ¬ë¦¬</span> <span class="text-gray-300 mx-1">â€º</span> ${catTitle}`;
                subtitle.textContent = '';
                subtitle.classList.add('hidden');
                levelTabWrapper.classList.add('hidden');
                seriesTabWrapper.classList.remove('hidden');
            } else {
                // ëª©ë¡ ëª¨ë“œ: ì•„ì´ì½˜ + íƒ€ì´í‹€ + ë ˆë²¨ íƒ­
                iconLibrary.classList.remove('hidden');
                backBtn.classList.add('hidden');
                title.textContent = 'ë¼ì´ë¸ŒëŸ¬ë¦¬';
                subtitle.textContent = 'ì „ì²´ ë„ì„œë¥¼ ë‹¨ê³„ë³„ë¡œ íƒìƒ‰í•´ë³´ì„¸ìš”';
                subtitle.classList.remove('hidden');
                levelTabWrapper.classList.remove('hidden');
                seriesTabWrapper.classList.add('hidden');
            }
        }

        // ===== Level Tab Switching =====
        function switchLevel(level) {
            document.querySelectorAll('.level-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.level === level) tab.classList.add('active');
            });

            currentLevel = level;
            currentView = 'grid';
            currentCategory = null;

            // í—¤ë”ë¥¼ ëª©ë¡ ëª¨ë“œë¡œ ë³µì›
            setHeaderMode('grid');

            // ëª¨ë“  ë·° ìˆ¨ê¸°ê¸°
            document.getElementById('category-grid-view').classList.add('hidden');
            document.getElementById('book-list-view').classList.add('hidden');
            document.getElementById('empty-lv7').classList.add('hidden');
            document.getElementById('empty-lv7plus').classList.add('hidden');
            document.getElementById('empty-liked').classList.add('hidden');
            document.getElementById('empty-recent').classList.add('hidden');

            if (level === 'lv7') {
                document.getElementById('empty-lv7').classList.remove('hidden');
            } else if (level === 'lv7plus') {
                document.getElementById('empty-lv7plus').classList.remove('hidden');
            } else if (level === 'liked') {
                document.getElementById('empty-liked').classList.remove('hidden');
            } else if (level === 'recent') {
                document.getElementById('empty-recent').classList.remove('hidden');
            } else {
                document.getElementById('category-grid-view').classList.remove('hidden');
                renderCategoryGrid();
            }

            document.querySelector('main').scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ===== ì¹´í…Œê³ ë¦¬ë³„ CSS í´ë˜ìŠ¤ & íƒœê·¸ë¼ì¸ ë§¤í•‘ =====
        const catMeta = {
            'lang':      { css: 'cat-lang',      tagline: 'ë§í•˜ê¸° ëŒ€ì¥ì´ ë˜ì–´ë³´ì!' },
            'social':    { css: 'cat-social',     tagline: 'ì„¸ìƒì€ ë„“ê³  ì¬ë°Œì–´!' },
            'science':   { css: 'cat-science',    tagline: 'ì™œ? ë¥¼ ì°¾ì•„ ë– ë‚˜ëŠ” ëª¨í—˜!' },
            'art':       { css: 'cat-art',        tagline: 'ë§ˆìŒê» í‘œí˜„í•´ë´!' },
            'knowledge': { css: 'cat-knowledge',  tagline: 'ì•Œë©´ ì•Œìˆ˜ë¡ ì‹ ê¸°í•´!' },
            'english':   { css: 'cat-english',    tagline: 'Hello! ì˜ì–´ë‘ ë†€ì!' },
            'audio':     { css: 'cat-audio',      tagline: 'ê·€ë¥¼ ì«‘ê¸‹! ë“¤ì–´ë´!' },
            'plus':      { css: 'cat-plus',       tagline: 'ë” ì¬ë°ŒëŠ” ê²Œ ìˆ¨ì–´ìˆì–´!' },
            'textbook':  { css: 'cat-textbook',   tagline: 'êµê³¼ì„œ ì† ì´ì•¼ê¸° íƒí—˜!' },
            'kinder':    { css: 'cat-kinder',     tagline: 'ìœ ì¹˜ì› ì¹œêµ¬ë“¤ ëª¨ì—¬ë¼!' },
            'subscribe': { css: 'cat-subscribe',  tagline: 'ë§¤ë‹¬ ìƒˆ ì±…ì´ ë„ì°©í•´!' },
            'app':       { css: 'cat-app',        tagline: 'ì•±ìœ¼ë¡œ ë” ì‹ ë‚˜ê²Œ!' }
        };

        // ===== ì¹´í…Œê³ ë¦¬ ê·¸ë¦¬ë“œ ë Œë”ë§ =====
        function renderCategoryGrid() {
            const data = libraryData[currentLevel] || [];
            const grid = document.getElementById('category-grid');

            grid.innerHTML = data.map(cat => {
                const meta = catMeta[cat.id] || { css: 'cat-lang', tagline: '' };
                return `
                <div class="category-card ${meta.css}" onclick="openCategory('${cat.id}')">
                    <div class="category-card-inner">
                        <div class="category-card-icon-box">${cat.icon}</div>
                        <div class="category-card-title">${cat.title}</div>
                        <div class="category-card-tagline">${meta.tagline}</div>
                    </div>
                </div>`;
            }).join('');

            // ì• ë‹ˆë©”ì´ì…˜
            const gridView = document.getElementById('category-grid-view');
            gridView.classList.remove('view-fade-in', 'view-fade-back');
            gridView.classList.add('view-fade-back');
        }

        // ===== ì¹´í…Œê³ ë¦¬ í´ë¦­ â†’ ìƒì„¸ í˜ì´ì§€ (ì‹œë¦¬ì¦ˆ íƒ­ + ì±… ë¦¬ìŠ¤íŠ¸) =====
        function openCategory(catId) {
            const data = libraryData[currentLevel] || [];
            const cat = data.find(c => c.id === catId);
            if (!cat) return;

            currentCategory = cat;
            currentSeriesIndex = 0;
            currentView = 'detail';

            // í—¤ë”ë¥¼ ìƒì„¸ ëª¨ë“œë¡œ ì „í™˜
            setHeaderMode('detail', cat.title);

            // ì‹œë¦¬ì¦ˆ íƒ­ ë Œë”ë§
            renderSeriesTabs(cat);

            // ì²« ë²ˆì§¸ ì‹œë¦¬ì¦ˆì˜ ì±… ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
            renderBookList(cat.series[0]);

            // ë·° ì „í™˜
            document.getElementById('category-grid-view').classList.add('hidden');
            const bookListView = document.getElementById('book-list-view');
            bookListView.classList.remove('hidden');
            bookListView.classList.remove('view-fade-in', 'view-fade-back');
            bookListView.classList.add('view-fade-in');

            document.querySelector('main').scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ===== ì‹œë¦¬ì¦ˆ íƒ­ ë Œë”ë§ =====
        function renderSeriesTabs(cat) {
            const tabBar = document.getElementById('series-tab-bar');
            tabBar.innerHTML = cat.series.map((s, i) => `
                <button class="series-tab ${i === 0 ? 'active' : ''}" data-series-index="${i}" onclick="switchSeriesTab(${i})">
                    ${s.emoji} ${s.title}
                </button>
            `).join('');
        }

        // ===== ì‹œë¦¬ì¦ˆ íƒ­ ì „í™˜ =====
        function switchSeriesTab(index) {
            if (!currentCategory) return;

            currentSeriesIndex = index;

            // íƒ­ active ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.series-tab').forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });

            // í•´ë‹¹ ì‹œë¦¬ì¦ˆì˜ ì±… ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
            const series = currentCategory.series[index];
            renderBookList(series);

            // ìŠ¤í¬ë¡¤ ìƒë‹¨ìœ¼ë¡œ
            document.querySelector('main').scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ===== ì½˜í…ì¸  ê·¸ë¦¬ë“œ ë Œë”ë§ =====
        function renderBookList(series) {
            const contents = generateContents(series.title, 25);
            const grid = document.getElementById('content-grid');

            grid.innerHTML = contents.map(item => {
                const ct = contentTypes[item.type];
                return `
                <div class="content-card" onclick="openBook('${item.id}', '${series.title}')">
                    <div class="content-thumb ${item.bg}">
                        <span class="content-thumb-emoji">${item.emoji}</span>
                        <span class="content-type-badge ${ct.badge}"><i class="${ct.icon}" style="font-size:9px;margin-right:3px"></i>${ct.label}</span>
                    </div>
                    <div class="content-info">
                        <div class="content-title">${item.title}</div>
                        <div class="content-meta">${series.title}</div>
                    </div>
                </div>`;
            }).join('');

            // ì• ë‹ˆë©”ì´ì…˜
            const bookView = document.getElementById('book-list-view');
            bookView.classList.remove('view-fade-in');
            void bookView.offsetWidth;
            bookView.classList.add('view-fade-in');
        }

        // ===== ë’¤ë¡œê°€ê¸° â†’ ì¹´í…Œê³ ë¦¬ ê·¸ë¦¬ë“œ =====
        function backToCategories() {
            currentCategory = null;
            currentView = 'grid';

            // í—¤ë”ë¥¼ ëª©ë¡ ëª¨ë“œë¡œ ë³µì›
            setHeaderMode('grid');

            // ë·° ì „í™˜
            document.getElementById('book-list-view').classList.add('hidden');
            const gridView = document.getElementById('category-grid-view');
            gridView.classList.remove('hidden');
            gridView.classList.remove('view-fade-in', 'view-fade-back');
            gridView.classList.add('view-fade-back');

            document.querySelector('main').scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ===== ì±… í´ë¦­ =====
        function openBook(bookId, seriesTitle) {
            // ì¶”í›„ book-viewer ì—°ë™
            console.log(`ë„ì„œ ì—´ê¸°: ${seriesTitle} - ${bookId}`);
        }

        // ===== Init =====
        document.addEventListener('DOMContentLoaded', () => {
            loadSidebar('book-library');
            loadLogoutModal();
            renderCategoryGrid();
        });
    </script>
</body>
</html>
